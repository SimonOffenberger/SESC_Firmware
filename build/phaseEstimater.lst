ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"phaseEstimater.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "Core/Src/phaseEstimater.c"
  20              		.section	.text.init_phase_estimater,"ax",%progbits
  21              		.align	1
  22              		.global	init_phase_estimater
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	init_phase_estimater:
  28              	.LFB126:
   1:Core/Src/phaseEstimater.c **** /**
   2:Core/Src/phaseEstimater.c ****   ******************************************************************************
   3:Core/Src/phaseEstimater.c ****   * @file    adc.c
   4:Core/Src/phaseEstimater.c ****   * @brief   This file provides code for the configuration
   5:Core/Src/phaseEstimater.c ****   *          of the ADC instances.
   6:Core/Src/phaseEstimater.c ****   ******************************************************************************
   7:Core/Src/phaseEstimater.c ****   * @attention
   8:Core/Src/phaseEstimater.c ****   *
   9:Core/Src/phaseEstimater.c ****   * <h2><center>&copy; Copyright (c) 2021 STMicroelectronics.
  10:Core/Src/phaseEstimater.c ****   * All rights reserved.</center></h2>
  11:Core/Src/phaseEstimater.c ****   *
  12:Core/Src/phaseEstimater.c ****   * This software component is licensed by ST under BSD 3-Clause license,
  13:Core/Src/phaseEstimater.c ****   * the "License"; You may not use this file except in compliance with the
  14:Core/Src/phaseEstimater.c ****   * License. You may obtain a copy of the License at:
  15:Core/Src/phaseEstimater.c ****   *                        opensource.org/licenses/BSD-3-Clause
  16:Core/Src/phaseEstimater.c ****   *
  17:Core/Src/phaseEstimater.c ****   ******************************************************************************
  18:Core/Src/phaseEstimater.c ****   */
  19:Core/Src/phaseEstimater.c **** 
  20:Core/Src/phaseEstimater.c **** /* Includes ------------------------------------------------------------------*/
  21:Core/Src/phaseEstimater.c **** #include "phaseEstimater.h"
  22:Core/Src/phaseEstimater.c **** #include "SVM.h"
  23:Core/Src/phaseEstimater.c **** #include "encoder.h"
  24:Core/Src/phaseEstimater.c **** #include "main.h"
  25:Core/Src/phaseEstimater.c **** #include "tim.h"
  26:Core/Src/phaseEstimater.c **** #include "global_var.h"
  27:Core/Src/phaseEstimater.c **** #include <string.h>
  28:Core/Src/phaseEstimater.c **** #include <stdio.h>
  29:Core/Src/phaseEstimater.c **** #include <stdlib.h>
  30:Core/Src/phaseEstimater.c **** #include <math.h>
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 2


  31:Core/Src/phaseEstimater.c **** #include "uart_debug.h"
  32:Core/Src/phaseEstimater.c ****  
  33:Core/Src/phaseEstimater.c **** static uint16_t phase=0;
  34:Core/Src/phaseEstimater.c **** 
  35:Core/Src/phaseEstimater.c **** //#define SectorA 4 0�   offset
  36:Core/Src/phaseEstimater.c **** //#define SectorB 6 60�  offset
  37:Core/Src/phaseEstimater.c **** //#define SectorC 2 120� offset
  38:Core/Src/phaseEstimater.c **** //#define SectorD 3 180� offset
  39:Core/Src/phaseEstimater.c **** //#define SectorE 1 240� offset
  40:Core/Src/phaseEstimater.c **** //#define SectorF 5 300� offset
  41:Core/Src/phaseEstimater.c **** //																		//E   C   D   A F   B   X   X
  42:Core/Src/phaseEstimater.c **** //uint16_t HallSecotor_phase_offset[8]={255,240,120,180,0,300,60,255};
  43:Core/Src/phaseEstimater.c **** 
  44:Core/Src/phaseEstimater.c **** 																				//E   C   D   A F   B   X   X
  45:Core/Src/phaseEstimater.c **** //uint16_t HallSector_phase_offset[8]={255,350,230,275,93,35,156,255};
  46:Core/Src/phaseEstimater.c **** uint16_t  HallSector_Averages[8]={1};
  47:Core/Src/phaseEstimater.c **** uint16_t HallSector_phase_offset[8]={255};
  48:Core/Src/phaseEstimater.c **** uint16_t HallSector_phase_span[8]={0};
  49:Core/Src/phaseEstimater.c **** 
  50:Core/Src/phaseEstimater.c **** void init_phase_estimater(){
  29              		.loc 1 50 28 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
  51:Core/Src/phaseEstimater.c **** 	__HAL_TIM_DISABLE(&SectorTIM);
  34              		.loc 1 51 2 view .LVU1
  35              		.loc 1 51 2 view .LVU2
  36 0000 0D4B     		ldr	r3, .L3
  37 0002 1B68     		ldr	r3, [r3]
  38 0004 196A     		ldr	r1, [r3, #32]
  39 0006 41F21112 		movw	r2, #4369
  40 000a 1142     		tst	r1, r2
  41 000c 08D1     		bne	.L2
  42              		.loc 1 51 2 discriminator 1 view .LVU3
  43 000e 196A     		ldr	r1, [r3, #32]
  44 0010 40F24442 		movw	r2, #1092
  45 0014 1142     		tst	r1, r2
  46 0016 03D1     		bne	.L2
  47              		.loc 1 51 2 discriminator 3 view .LVU4
  48 0018 1A68     		ldr	r2, [r3]
  49 001a 22F00102 		bic	r2, r2, #1
  50 001e 1A60     		str	r2, [r3]
  51              	.L2:
  52              		.loc 1 51 2 discriminator 5 view .LVU5
  52:Core/Src/phaseEstimater.c **** 	SectorTIM.Instance->ARR=65535;
  53              		.loc 1 52 2 view .LVU6
  54              		.loc 1 52 11 is_stmt 0 view .LVU7
  55 0020 054B     		ldr	r3, .L3
  56 0022 1B68     		ldr	r3, [r3]
  57              		.loc 1 52 25 view .LVU8
  58 0024 4FF6FF72 		movw	r2, #65535
  59 0028 DA62     		str	r2, [r3, #44]
  53:Core/Src/phaseEstimater.c **** 	SectorTIM.Instance->PSC=6;
  60              		.loc 1 53 2 is_stmt 1 view .LVU9
  61              		.loc 1 53 25 is_stmt 0 view .LVU10
  62 002a 0622     		movs	r2, #6
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 3


  63 002c 9A62     		str	r2, [r3, #40]
  54:Core/Src/phaseEstimater.c **** 	__HAL_TIM_ENABLE(&SectorTIM);
  64              		.loc 1 54 2 is_stmt 1 view .LVU11
  65 002e 1A68     		ldr	r2, [r3]
  66 0030 42F00102 		orr	r2, r2, #1
  67 0034 1A60     		str	r2, [r3]
  55:Core/Src/phaseEstimater.c **** }
  68              		.loc 1 55 1 is_stmt 0 view .LVU12
  69 0036 7047     		bx	lr
  70              	.L4:
  71              		.align	2
  72              	.L3:
  73 0038 00000000 		.word	htim6
  74              		.cfi_endproc
  75              	.LFE126:
  77              		.section	.rodata.initialize_Hallsensor_phase_estimator.str1.4,"aMS",%progbits,1
  78              		.align	2
  79              	.LC0:
  80 0000 48616C6C 		.ascii	"Hallsektor: \000"
  80      73656B74 
  80      6F723A20 
  80      00
  81 000d 000000   		.align	2
  82              	.LC1:
  83 0010 204F6666 		.ascii	" Offset: \000"
  83      7365743A 
  83      2000
  84 001a 0000     		.align	2
  85              	.LC2:
  86 001c 20506861 		.ascii	" Phasespan: \000"
  86      73657370 
  86      616E3A20 
  86      00
  87              		.section	.text.initialize_Hallsensor_phase_estimator,"ax",%progbits
  88              		.align	1
  89              		.global	initialize_Hallsensor_phase_estimator
  90              		.syntax unified
  91              		.thumb
  92              		.thumb_func
  94              	initialize_Hallsensor_phase_estimator:
  95              	.LVL0:
  96              	.LFB127:
  56:Core/Src/phaseEstimater.c **** 
  57:Core/Src/phaseEstimater.c **** uint16_t time_between_sectors=0;
  58:Core/Src/phaseEstimater.c **** 
  59:Core/Src/phaseEstimater.c **** 
  60:Core/Src/phaseEstimater.c **** uint16_t initialize_Hallsensor_phase_estimator(uint16_t setpoint){
  97              		.loc 1 60 66 is_stmt 1 view -0
  98              		.cfi_startproc
  99              		@ args = 0, pretend = 0, frame = 0
 100              		@ frame_needed = 0, uses_anonymous_args = 0
 101              		.loc 1 60 66 is_stmt 0 view .LVU14
 102 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 103              	.LCFI0:
 104              		.cfi_def_cfa_offset 32
 105              		.cfi_offset 3, -32
 106              		.cfi_offset 4, -28
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 4


 107              		.cfi_offset 5, -24
 108              		.cfi_offset 6, -20
 109              		.cfi_offset 7, -16
 110              		.cfi_offset 8, -12
 111              		.cfi_offset 9, -8
 112              		.cfi_offset 14, -4
 113 0004 0546     		mov	r5, r0
  61:Core/Src/phaseEstimater.c **** 	uint16_t init_done=0;
 114              		.loc 1 61 2 is_stmt 1 view .LVU15
 115              	.LVL1:
  62:Core/Src/phaseEstimater.c **** 	uint8_t HallSector=0;
 116              		.loc 1 62 2 view .LVU16
  63:Core/Src/phaseEstimater.c **** 	uint16_t in_toleranz_count=0;
 117              		.loc 1 63 2 view .LVU17
  64:Core/Src/phaseEstimater.c **** 
  65:Core/Src/phaseEstimater.c **** 	static uint16_t voltage_phase=0;
 118              		.loc 1 65 2 view .LVU18
  66:Core/Src/phaseEstimater.c **** 	static uint8_t HALL1 = 0;
 119              		.loc 1 66 2 view .LVU19
  67:Core/Src/phaseEstimater.c **** 	static uint8_t HALL2 = 0;
 120              		.loc 1 67 2 view .LVU20
  68:Core/Src/phaseEstimater.c **** 	static uint8_t HALL3 = 0;
 121              		.loc 1 68 2 view .LVU21
  69:Core/Src/phaseEstimater.c **** 	static uint8_t init=0;
 122              		.loc 1 69 2 view .LVU22
  70:Core/Src/phaseEstimater.c **** 
  71:Core/Src/phaseEstimater.c **** 	static uint8_t lock_HALL1=1;
 123              		.loc 1 71 2 view .LVU23
  72:Core/Src/phaseEstimater.c **** 	static uint8_t lock_HALL2=0;
 124              		.loc 1 72 2 view .LVU24
  73:Core/Src/phaseEstimater.c **** 	static uint8_t lock_HALL3=0;
 125              		.loc 1 73 2 view .LVU25
  74:Core/Src/phaseEstimater.c **** 
  75:Core/Src/phaseEstimater.c **** 	static uint16_t phase_old=0;
 126              		.loc 1 75 2 view .LVU26
  76:Core/Src/phaseEstimater.c **** 
  77:Core/Src/phaseEstimater.c **** 	static uint8_t prev_Sector=0;
 127              		.loc 1 77 2 view .LVU27
  78:Core/Src/phaseEstimater.c **** 
  79:Core/Src/phaseEstimater.c **** 	if(!init){
 128              		.loc 1 79 2 view .LVU28
 129              		.loc 1 79 5 is_stmt 0 view .LVU29
 130 0006 AA4B     		ldr	r3, .L45
 131 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 132              		.loc 1 79 4 view .LVU30
 133 000a 53B9     		cbnz	r3, .L6
  80:Core/Src/phaseEstimater.c **** 		// configure Sector Tim to Output a 10Hz Sinewave;
  81:Core/Src/phaseEstimater.c **** 		SectorTIM.Instance-> ARR= 360;
 134              		.loc 1 81 3 is_stmt 1 view .LVU31
 135              		.loc 1 81 12 is_stmt 0 view .LVU32
 136 000c A94B     		ldr	r3, .L45+4
 137 000e 1B68     		ldr	r3, [r3]
 138              		.loc 1 81 27 view .LVU33
 139 0010 4FF4B472 		mov	r2, #360
 140 0014 DA62     		str	r2, [r3, #44]
  82:Core/Src/phaseEstimater.c **** 		SectorTIM.Instance-> PSC = 30000;
 141              		.loc 1 82 3 is_stmt 1 view .LVU34
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 5


 142              		.loc 1 82 28 is_stmt 0 view .LVU35
 143 0016 47F23052 		movw	r2, #30000
 144 001a 9A62     		str	r2, [r3, #40]
  83:Core/Src/phaseEstimater.c **** 		init=1;
 145              		.loc 1 83 3 is_stmt 1 view .LVU36
 146              		.loc 1 83 7 is_stmt 0 view .LVU37
 147 001c A44B     		ldr	r3, .L45
 148 001e 0122     		movs	r2, #1
 149 0020 1A70     		strb	r2, [r3]
 150              	.L6:
  84:Core/Src/phaseEstimater.c **** 	}
  85:Core/Src/phaseEstimater.c **** 
  86:Core/Src/phaseEstimater.c **** 	voltage_phase = SectorTIM.Instance->CNT;
 151              		.loc 1 86 2 is_stmt 1 view .LVU38
 152              		.loc 1 86 27 is_stmt 0 view .LVU39
 153 0022 A44B     		ldr	r3, .L45+4
 154 0024 1B68     		ldr	r3, [r3]
 155              		.loc 1 86 36 view .LVU40
 156 0026 5B6A     		ldr	r3, [r3, #36]
 157              		.loc 1 86 16 view .LVU41
 158 0028 9BB2     		uxth	r3, r3
 159 002a A34A     		ldr	r2, .L45+8
 160 002c 1380     		strh	r3, [r2]	@ movhi
  87:Core/Src/phaseEstimater.c **** 	Motor.rotorphase=voltage_phase;
 161              		.loc 1 87 2 is_stmt 1 view .LVU42
 162              		.loc 1 87 18 is_stmt 0 view .LVU43
 163 002e A34A     		ldr	r2, .L45+12
 164 0030 1380     		strh	r3, [r2]	@ movhi
  88:Core/Src/phaseEstimater.c **** 	HALL1 = (HALL1<<1)|HAL_GPIO_ReadPin(HALL1_GPIO_Port,HALL1_Pin);
 165              		.loc 1 88 2 is_stmt 1 view .LVU44
 166              		.loc 1 88 20 is_stmt 0 view .LVU45
 167 0032 A34E     		ldr	r6, .L45+16
 168 0034 3478     		ldrb	r4, [r6]	@ zero_extendqisi2
 169              		.loc 1 88 21 view .LVU46
 170 0036 A34F     		ldr	r7, .L45+20
 171 0038 0421     		movs	r1, #4
 172 003a 3846     		mov	r0, r7
 173              	.LVL2:
 174              		.loc 1 88 21 view .LVU47
 175 003c FFF7FEFF 		bl	HAL_GPIO_ReadPin
 176              	.LVL3:
 177              		.loc 1 88 20 discriminator 1 view .LVU48
 178 0040 40EA4400 		orr	r0, r0, r4, lsl #1
 179              		.loc 1 88 8 discriminator 1 view .LVU49
 180 0044 3070     		strb	r0, [r6]
  89:Core/Src/phaseEstimater.c **** 	HALL2 = (HALL2<<1)|HAL_GPIO_ReadPin(HALL2_GPIO_Port,HALL2_Pin);
 181              		.loc 1 89 2 is_stmt 1 view .LVU50
 182              		.loc 1 89 20 is_stmt 0 view .LVU51
 183 0046 A04C     		ldr	r4, .L45+24
 184 0048 94F80080 		ldrb	r8, [r4]	@ zero_extendqisi2
 185              		.loc 1 89 21 view .LVU52
 186 004c 4FF48061 		mov	r1, #1024
 187 0050 3846     		mov	r0, r7
 188 0052 FFF7FEFF 		bl	HAL_GPIO_ReadPin
 189              	.LVL4:
 190              		.loc 1 89 20 discriminator 1 view .LVU53
 191 0056 40EA4800 		orr	r0, r0, r8, lsl #1
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 6


 192              		.loc 1 89 8 discriminator 1 view .LVU54
 193 005a 2070     		strb	r0, [r4]
  90:Core/Src/phaseEstimater.c **** 	HALL3 = (HALL3<<1)|HAL_GPIO_ReadPin(HALL3_GPIO_Port,HALL3_Pin);
 194              		.loc 1 90 2 is_stmt 1 view .LVU55
 195              		.loc 1 90 20 is_stmt 0 view .LVU56
 196 005c DFF89082 		ldr	r8, .L45+64
 197 0060 98F80090 		ldrb	r9, [r8]	@ zero_extendqisi2
 198              		.loc 1 90 21 view .LVU57
 199 0064 4FF40061 		mov	r1, #2048
 200 0068 3846     		mov	r0, r7
 201 006a FFF7FEFF 		bl	HAL_GPIO_ReadPin
 202              	.LVL5:
 203              		.loc 1 90 20 discriminator 1 view .LVU58
 204 006e 40EA4903 		orr	r3, r0, r9, lsl #1
 205 0072 DBB2     		uxtb	r3, r3
 206              		.loc 1 90 8 discriminator 1 view .LVU59
 207 0074 88F80030 		strb	r3, [r8]
  91:Core/Src/phaseEstimater.c **** 
  92:Core/Src/phaseEstimater.c **** 	uint8_t HALL1_rising_edge =		  (HALL1&0x0F)==3;
 208              		.loc 1 92 2 is_stmt 1 view .LVU60
 209              		.loc 1 92 39 is_stmt 0 view .LVU61
 210 0078 3178     		ldrb	r1, [r6]	@ zero_extendqisi2
 211 007a 01F00F01 		and	r1, r1, #15
 212              		.loc 1 92 45 view .LVU62
 213 007e 0329     		cmp	r1, #3
 214 0080 14BF     		ite	ne
 215 0082 0020     		movne	r0, #0
 216 0084 0120     		moveq	r0, #1
 217              	.LVL6:
  93:Core/Src/phaseEstimater.c **** 	uint8_t HALL1_falling_edge=	    (HALL1&0x0F)==14;
 218              		.loc 1 93 2 is_stmt 1 view .LVU63
 219              		.loc 1 93 46 is_stmt 0 view .LVU64
 220 0086 0E29     		cmp	r1, #14
 221 0088 14BF     		ite	ne
 222 008a 0026     		movne	r6, #0
 223 008c 0126     		moveq	r6, #1
 224              	.LVL7:
  94:Core/Src/phaseEstimater.c **** 	uint8_t HALL2_rising_edge =		  (HALL2&0x0F)==3;
 225              		.loc 1 94 2 is_stmt 1 view .LVU65
 226              		.loc 1 94 39 is_stmt 0 view .LVU66
 227 008e 2278     		ldrb	r2, [r4]	@ zero_extendqisi2
 228 0090 02F00F02 		and	r2, r2, #15
 229              		.loc 1 94 45 view .LVU67
 230 0094 032A     		cmp	r2, #3
 231 0096 14BF     		ite	ne
 232 0098 0024     		movne	r4, #0
 233 009a 0124     		moveq	r4, #1
 234              	.LVL8:
  95:Core/Src/phaseEstimater.c **** 	uint8_t HALL2_falling_edge=	    (HALL2&0x0F)==14;
 235              		.loc 1 95 2 is_stmt 1 view .LVU68
 236              		.loc 1 95 46 is_stmt 0 view .LVU69
 237 009c 0E2A     		cmp	r2, #14
 238 009e 14BF     		ite	ne
 239 00a0 0027     		movne	r7, #0
 240 00a2 0127     		moveq	r7, #1
 241              	.LVL9:
  96:Core/Src/phaseEstimater.c **** 	uint8_t HALL3_rising_edge =		  (HALL3&0x0F)==3;
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 7


 242              		.loc 1 96 2 is_stmt 1 view .LVU70
 243 00a4 03F00F03 		and	r3, r3, #15
 244              		.loc 1 96 45 is_stmt 0 view .LVU71
 245 00a8 032B     		cmp	r3, #3
 246 00aa 14BF     		ite	ne
 247 00ac 4FF0000C 		movne	ip, #0
 248 00b0 4FF0010C 		moveq	ip, #1
 249              	.LVL10:
  97:Core/Src/phaseEstimater.c **** 	uint8_t HALL3_falling_edge=	    (HALL3&0x0F)==14;
 250              		.loc 1 97 2 is_stmt 1 view .LVU72
 251              		.loc 1 97 46 is_stmt 0 view .LVU73
 252 00b4 0E2B     		cmp	r3, #14
 253 00b6 14BF     		ite	ne
 254 00b8 4FF0000E 		movne	lr, #0
 255 00bc 4FF0010E 		moveq	lr, #1
 256              	.LVL11:
  98:Core/Src/phaseEstimater.c **** 
  99:Core/Src/phaseEstimater.c **** 	uint8_t valid_signals=0;
 257              		.loc 1 99 2 is_stmt 1 view .LVU74
 100:Core/Src/phaseEstimater.c **** 
 101:Core/Src/phaseEstimater.c **** 	//Bei einer Flanke wenn diese nicht gerade gelockt ist
 102:Core/Src/phaseEstimater.c **** 	if((HALL1_falling_edge||HALL1_rising_edge)&&!lock_HALL1){
 258              		.loc 1 102 2 view .LVU75
 259              		.loc 1 102 4 is_stmt 0 view .LVU76
 260 00c0 0E29     		cmp	r1, #14
 261 00c2 5DD0     		beq	.L7
 262              		.loc 1 102 24 discriminator 2 view .LVU77
 263 00c4 0329     		cmp	r1, #3
 264 00c6 5BD0     		beq	.L7
  99:Core/Src/phaseEstimater.c **** 
 265              		.loc 1 99 10 view .LVU78
 266 00c8 0021     		movs	r1, #0
 267              	.LVL12:
 268              	.L8:
 103:Core/Src/phaseEstimater.c **** 		lock_HALL1=1;
 104:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 105:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 106:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 107:Core/Src/phaseEstimater.c **** 	}
 108:Core/Src/phaseEstimater.c **** 	//Bei einer Flanke wenn diese nicht gerade gelockt ist
 109:Core/Src/phaseEstimater.c **** 	if((HALL2_falling_edge||HALL2_rising_edge)&&!lock_HALL2){
 269              		.loc 1 109 2 is_stmt 1 view .LVU79
 270              		.loc 1 109 4 is_stmt 0 view .LVU80
 271 00ca 0E2A     		cmp	r2, #14
 272 00cc 00F08480 		beq	.L10
 273              		.loc 1 109 24 discriminator 2 view .LVU81
 274 00d0 032A     		cmp	r2, #3
 275 00d2 00F08180 		beq	.L10
 276              	.L11:
 110:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 111:Core/Src/phaseEstimater.c **** 		lock_HALL2=1;
 112:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 113:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 114:Core/Src/phaseEstimater.c **** 	}
 115:Core/Src/phaseEstimater.c **** 	//Bei einer Flanke wenn diese nicht gerade gelockt ist
 116:Core/Src/phaseEstimater.c **** 	if((HALL3_falling_edge||HALL3_rising_edge)&&!lock_HALL3){
 277              		.loc 1 116 2 is_stmt 1 view .LVU82
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 8


 278              		.loc 1 116 4 is_stmt 0 view .LVU83
 279 00d6 0E2B     		cmp	r3, #14
 280 00d8 00F0A580 		beq	.L13
 281              		.loc 1 116 24 discriminator 2 view .LVU84
 282 00dc 032B     		cmp	r3, #3
 283 00de 00F0A280 		beq	.L13
 284              	.L14:
 117:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 118:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 119:Core/Src/phaseEstimater.c **** 		lock_HALL3=1;
 120:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 121:Core/Src/phaseEstimater.c **** 	}
 122:Core/Src/phaseEstimater.c **** 
 123:Core/Src/phaseEstimater.c **** 
 124:Core/Src/phaseEstimater.c **** 	if(valid_signals){
 285              		.loc 1 124 2 is_stmt 1 view .LVU85
 286              		.loc 1 124 4 is_stmt 0 view .LVU86
 287 00e2 0029     		cmp	r1, #0
 288 00e4 49D0     		beq	.L16
 289              	.L15:
 290              	.LVL13:
 125:Core/Src/phaseEstimater.c **** 		HAL_GPIO_TogglePin(GPIOB, GPIO_PIN_12);
 291              		.loc 1 125 3 is_stmt 1 view .LVU87
 292 00e6 4FF48051 		mov	r1, #4096
 293 00ea 7648     		ldr	r0, .L45+20
 294              	.LVL14:
 295              		.loc 1 125 3 is_stmt 0 view .LVU88
 296 00ec FFF7FEFF 		bl	HAL_GPIO_TogglePin
 297              	.LVL15:
 126:Core/Src/phaseEstimater.c **** 
 127:Core/Src/phaseEstimater.c **** 		if(phase_old < voltage_phase){
 298              		.loc 1 127 3 is_stmt 1 view .LVU89
 299              		.loc 1 127 16 is_stmt 0 view .LVU90
 300 00f0 764B     		ldr	r3, .L45+28
 301 00f2 1B88     		ldrh	r3, [r3]
 302 00f4 704A     		ldr	r2, .L45+8
 303 00f6 1288     		ldrh	r2, [r2]
 304              		.loc 1 127 5 view .LVU91
 305 00f8 9342     		cmp	r3, r2
 306 00fa 80F0B580 		bcs	.L17
 128:Core/Src/phaseEstimater.c **** 			time_between_sectors = voltage_phase - phase_old;
 307              		.loc 1 128 4 is_stmt 1 view .LVU92
 308              		.loc 1 128 41 is_stmt 0 view .LVU93
 309 00fe D31A     		subs	r3, r2, r3
 310              		.loc 1 128 25 view .LVU94
 311 0100 7349     		ldr	r1, .L45+32
 312 0102 0B80     		strh	r3, [r1]	@ movhi
 313              	.L18:
 129:Core/Src/phaseEstimater.c **** 		}
 130:Core/Src/phaseEstimater.c **** 		else{
 131:Core/Src/phaseEstimater.c **** 			time_between_sectors =360 - (phase_old - voltage_phase);
 132:Core/Src/phaseEstimater.c **** 		}
 133:Core/Src/phaseEstimater.c **** 		phase_old = voltage_phase;
 314              		.loc 1 133 3 is_stmt 1 view .LVU95
 315              		.loc 1 133 13 is_stmt 0 view .LVU96
 316 0104 714B     		ldr	r3, .L45+28
 317 0106 1A80     		strh	r2, [r3]	@ movhi
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 9


 134:Core/Src/phaseEstimater.c **** 		HallSector = (HAL_GPIO_ReadPin(HALL3_GPIO_Port,HALL3_Pin)<<2)|(HAL_GPIO_ReadPin(HALL2_GPIO_Port,H
 318              		.loc 1 134 3 is_stmt 1 view .LVU97
 319              		.loc 1 134 17 is_stmt 0 view .LVU98
 320 0108 6E4E     		ldr	r6, .L45+20
 321              	.LVL16:
 322              		.loc 1 134 17 view .LVU99
 323 010a 4FF40061 		mov	r1, #2048
 324 010e 3046     		mov	r0, r6
 325 0110 FFF7FEFF 		bl	HAL_GPIO_ReadPin
 326              	.LVL17:
 327 0114 0746     		mov	r7, r0
 328              	.LVL18:
 329              		.loc 1 134 66 discriminator 1 view .LVU100
 330 0116 4FF48061 		mov	r1, #1024
 331 011a 3046     		mov	r0, r6
 332 011c FFF7FEFF 		bl	HAL_GPIO_ReadPin
 333              	.LVL19:
 334              		.loc 1 134 64 discriminator 2 view .LVU101
 335 0120 4400     		lsls	r4, r0, #1
 336              	.LVL20:
 337              		.loc 1 134 64 discriminator 2 view .LVU102
 338 0122 44EA8704 		orr	r4, r4, r7, lsl #2
 339 0126 64B2     		sxtb	r4, r4
 340              		.loc 1 134 115 discriminator 2 view .LVU103
 341 0128 0421     		movs	r1, #4
 342 012a 3046     		mov	r0, r6
 343 012c FFF7FEFF 		bl	HAL_GPIO_ReadPin
 344              	.LVL21:
 345              		.loc 1 134 14 discriminator 3 view .LVU104
 346 0130 2043     		orrs	r0, r0, r4
 347 0132 C0B2     		uxtb	r0, r0
 348              	.LVL22:
 135:Core/Src/phaseEstimater.c **** 
 136:Core/Src/phaseEstimater.c **** 		if(time_between_sectors>45 && time_between_sectors <75){
 349              		.loc 1 136 3 is_stmt 1 view .LVU105
 350              		.loc 1 136 30 is_stmt 0 view .LVU106
 351 0134 664B     		ldr	r3, .L45+32
 352 0136 1B88     		ldrh	r3, [r3]
 353 0138 2E3B     		subs	r3, r3, #46
 354 013a 9BB2     		uxth	r3, r3
 355              		.loc 1 136 5 view .LVU107
 356 013c 1C2B     		cmp	r3, #28
 357 013e 1AD8     		bhi	.L19
 137:Core/Src/phaseEstimater.c **** 
 138:Core/Src/phaseEstimater.c **** 			HallSector_phase_offset[HallSector] = (HallSector_Averages[HallSector] * voltage_phase) /(HallSe
 358              		.loc 1 138 4 is_stmt 1 view .LVU108
 359              		.loc 1 138 62 is_stmt 0 view .LVU109
 360 0140 644C     		ldr	r4, .L45+36
 361 0142 34F81020 		ldrh	r2, [r4, r0, lsl #1]
 362              		.loc 1 138 75 view .LVU110
 363 0146 5C4B     		ldr	r3, .L45+8
 364 0148 1B88     		ldrh	r3, [r3]
 365 014a 02FB03F3 		mul	r3, r2, r3
 366              		.loc 1 138 126 view .LVU111
 367 014e 0132     		adds	r2, r2, #1
 368              		.loc 1 138 92 view .LVU112
 369 0150 93FBF2F3 		sdiv	r3, r3, r2
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 10


 370              		.loc 1 138 40 view .LVU113
 371 0154 9BB2     		uxth	r3, r3
 372 0156 6049     		ldr	r1, .L45+40
 373 0158 21F81030 		strh	r3, [r1, r0, lsl #1]	@ movhi
 139:Core/Src/phaseEstimater.c **** 			HallSector_Averages[HallSector] ++;
 374              		.loc 1 139 4 is_stmt 1 view .LVU114
 375              		.loc 1 139 36 is_stmt 0 view .LVU115
 376 015c 24F81020 		strh	r2, [r4, r0, lsl #1]	@ movhi
 140:Core/Src/phaseEstimater.c **** 
 141:Core/Src/phaseEstimater.c **** 			if( HallSector_phase_offset[HallSector]>HallSector_phase_offset[prev_Sector]){
 377              		.loc 1 141 4 is_stmt 1 view .LVU116
 378              		.loc 1 141 67 is_stmt 0 view .LVU117
 379 0160 5E4A     		ldr	r2, .L45+44
 380 0162 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 381 0164 31F81220 		ldrh	r2, [r1, r2, lsl #1]
 382              		.loc 1 141 6 view .LVU118
 383 0168 9342     		cmp	r3, r2
 384 016a 40F28380 		bls	.L20
 142:Core/Src/phaseEstimater.c **** 				HallSector_phase_span[HallSector] = HallSector_phase_offset[HallSector]-HallSector_phase_offset
 385              		.loc 1 142 5 is_stmt 1 view .LVU119
 386              		.loc 1 142 76 is_stmt 0 view .LVU120
 387 016e 9B1A     		subs	r3, r3, r2
 388              		.loc 1 142 39 view .LVU121
 389 0170 5B4A     		ldr	r2, .L45+48
 390 0172 22F81030 		strh	r3, [r2, r0, lsl #1]	@ movhi
 391              	.L19:
 143:Core/Src/phaseEstimater.c **** 			}
 144:Core/Src/phaseEstimater.c **** 			else {
 145:Core/Src/phaseEstimater.c **** 				HallSector_phase_span[HallSector] =(360 + HallSector_phase_offset[HallSector]) - HallSector_pha
 146:Core/Src/phaseEstimater.c **** 			}
 147:Core/Src/phaseEstimater.c **** 
 148:Core/Src/phaseEstimater.c **** 
 149:Core/Src/phaseEstimater.c **** 		}
 150:Core/Src/phaseEstimater.c **** 		prev_Sector = HallSector;
 392              		.loc 1 150 3 is_stmt 1 view .LVU122
 393              		.loc 1 150 15 is_stmt 0 view .LVU123
 394 0176 594B     		ldr	r3, .L45+44
 395 0178 1870     		strb	r0, [r3]
 396              	.LVL23:
 397              	.L16:
 151:Core/Src/phaseEstimater.c **** 	}
 152:Core/Src/phaseEstimater.c **** 
 153:Core/Src/phaseEstimater.c **** 	for(int i=0; i<8;i++){
 398              		.loc 1 153 2 is_stmt 1 view .LVU124
 399              	.LBB2:
 400              		.loc 1 153 6 view .LVU125
 401              		.loc 1 153 10 is_stmt 0 view .LVU126
 402 017a 0023     		movs	r3, #0
 403              	.LBE2:
  63:Core/Src/phaseEstimater.c **** 
 404              		.loc 1 63 11 view .LVU127
 405 017c 1946     		mov	r1, r3
 406              	.LBB3:
 407              		.loc 1 153 2 view .LVU128
 408 017e 81E0     		b	.L21
 409              	.LVL24:
 410              	.L7:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 11


 411              		.loc 1 153 2 view .LVU129
 412              	.LBE3:
 102:Core/Src/phaseEstimater.c **** 		lock_HALL1=1;
 413              		.loc 1 102 46 discriminator 3 view .LVU130
 414 0180 5849     		ldr	r1, .L45+52
 415 0182 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
 102:Core/Src/phaseEstimater.c **** 		lock_HALL1=1;
 416              		.loc 1 102 44 discriminator 3 view .LVU131
 417 0184 31BB     		cbnz	r1, .L30
 103:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 418              		.loc 1 103 3 is_stmt 1 view .LVU132
 103:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 419              		.loc 1 103 13 is_stmt 0 view .LVU133
 420 0186 5749     		ldr	r1, .L45+52
 421 0188 4FF00108 		mov	r8, #1
 422 018c 81F80080 		strb	r8, [r1]
 104:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 423              		.loc 1 104 3 is_stmt 1 view .LVU134
 104:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 424              		.loc 1 104 13 is_stmt 0 view .LVU135
 425 0190 0021     		movs	r1, #0
 426 0192 DFF85481 		ldr	r8, .L45+56
 427 0196 88F80010 		strb	r1, [r8]
 105:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 428              		.loc 1 105 3 is_stmt 1 view .LVU136
 105:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 429              		.loc 1 105 13 is_stmt 0 view .LVU137
 430 019a DFF85081 		ldr	r8, .L45+60
 431 019e 88F80010 		strb	r1, [r8]
 106:Core/Src/phaseEstimater.c **** 	}
 432              		.loc 1 106 3 is_stmt 1 view .LVU138
 106:Core/Src/phaseEstimater.c **** 	}
 433              		.loc 1 106 148 is_stmt 0 view .LVU139
 434 01a2 60B9     		cbnz	r0, .L31
 106:Core/Src/phaseEstimater.c **** 	}
 435              		.loc 1 106 42 discriminator 2 view .LVU140
 436 01a4 76B9     		cbnz	r6, .L32
 106:Core/Src/phaseEstimater.c **** 	}
 437              		.loc 1 106 69 discriminator 4 view .LVU141
 438 01a6 7CB9     		cbnz	r4, .L33
 106:Core/Src/phaseEstimater.c **** 	}
 439              		.loc 1 106 95 discriminator 6 view .LVU142
 440 01a8 87B9     		cbnz	r7, .L34
 106:Core/Src/phaseEstimater.c **** 	}
 441              		.loc 1 106 122 discriminator 8 view .LVU143
 442 01aa BCF1000F 		cmp	ip, #0
 443 01ae 0FD1     		bne	.L35
 106:Core/Src/phaseEstimater.c **** 	}
 444              		.loc 1 106 148 discriminator 10 view .LVU144
 445 01b0 4FEA8E01 		lsl	r1, lr, #2
 446 01b4 BEF1000F 		cmp	lr, #0
 447 01b8 02D0     		beq	.L9
 106:Core/Src/phaseEstimater.c **** 	}
 448              		.loc 1 106 148 discriminator 11 view .LVU145
 449 01ba 0121     		movs	r1, #1
 450 01bc 00E0     		b	.L9
 451              	.L31:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 12


 452 01be 0121     		movs	r1, #1
 453              	.L9:
 106:Core/Src/phaseEstimater.c **** 	}
 454              		.loc 1 106 17 discriminator 14 view .LVU146
 455 01c0 C9B2     		uxtb	r1, r1
 456              	.LVL25:
 106:Core/Src/phaseEstimater.c **** 	}
 457              		.loc 1 106 17 discriminator 14 view .LVU147
 458 01c2 82E7     		b	.L8
 459              	.LVL26:
 460              	.L32:
 106:Core/Src/phaseEstimater.c **** 	}
 461              		.loc 1 106 148 discriminator 11 view .LVU148
 462 01c4 0121     		movs	r1, #1
 463 01c6 FBE7     		b	.L9
 464              	.L33:
 465 01c8 0121     		movs	r1, #1
 466 01ca F9E7     		b	.L9
 467              	.L34:
 468 01cc 0121     		movs	r1, #1
 469 01ce F7E7     		b	.L9
 470              	.L35:
 471 01d0 0121     		movs	r1, #1
 472 01d2 F5E7     		b	.L9
 473              	.L30:
  99:Core/Src/phaseEstimater.c **** 
 474              		.loc 1 99 10 view .LVU149
 475 01d4 0021     		movs	r1, #0
 476 01d6 78E7     		b	.L8
 477              	.LVL27:
 478              	.L10:
 109:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 479              		.loc 1 109 46 discriminator 3 view .LVU150
 480 01d8 434A     		ldr	r2, .L45+56
 481 01da 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 109:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 482              		.loc 1 109 44 discriminator 3 view .LVU151
 483 01dc 002A     		cmp	r2, #0
 484 01de 7FF47AAF 		bne	.L11
 110:Core/Src/phaseEstimater.c **** 		lock_HALL2=1;
 485              		.loc 1 110 3 is_stmt 1 view .LVU152
 110:Core/Src/phaseEstimater.c **** 		lock_HALL2=1;
 486              		.loc 1 110 13 is_stmt 0 view .LVU153
 487 01e2 4049     		ldr	r1, .L45+52
 488              	.LVL28:
 110:Core/Src/phaseEstimater.c **** 		lock_HALL2=1;
 489              		.loc 1 110 13 view .LVU154
 490 01e4 0A70     		strb	r2, [r1]
 111:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 491              		.loc 1 111 3 is_stmt 1 view .LVU155
 111:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 492              		.loc 1 111 13 is_stmt 0 view .LVU156
 493 01e6 4049     		ldr	r1, .L45+56
 494 01e8 4FF00108 		mov	r8, #1
 495 01ec 81F80080 		strb	r8, [r1]
 112:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 496              		.loc 1 112 3 is_stmt 1 view .LVU157
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 13


 112:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 497              		.loc 1 112 13 is_stmt 0 view .LVU158
 498 01f0 3E49     		ldr	r1, .L45+60
 499 01f2 0A70     		strb	r2, [r1]
 113:Core/Src/phaseEstimater.c **** 	}
 500              		.loc 1 113 3 is_stmt 1 view .LVU159
 113:Core/Src/phaseEstimater.c **** 	}
 501              		.loc 1 113 148 is_stmt 0 view .LVU160
 502 01f4 60B9     		cbnz	r0, .L36
 113:Core/Src/phaseEstimater.c **** 	}
 503              		.loc 1 113 42 discriminator 2 view .LVU161
 504 01f6 76B9     		cbnz	r6, .L37
 113:Core/Src/phaseEstimater.c **** 	}
 505              		.loc 1 113 69 discriminator 4 view .LVU162
 506 01f8 7CB9     		cbnz	r4, .L38
 113:Core/Src/phaseEstimater.c **** 	}
 507              		.loc 1 113 95 discriminator 6 view .LVU163
 508 01fa 87B9     		cbnz	r7, .L39
 113:Core/Src/phaseEstimater.c **** 	}
 509              		.loc 1 113 122 discriminator 8 view .LVU164
 510 01fc BCF1000F 		cmp	ip, #0
 511 0200 0FD1     		bne	.L40
 113:Core/Src/phaseEstimater.c **** 	}
 512              		.loc 1 113 148 discriminator 10 view .LVU165
 513 0202 4FEA8E01 		lsl	r1, lr, #2
 514 0206 BEF1000F 		cmp	lr, #0
 515 020a 02D0     		beq	.L12
 113:Core/Src/phaseEstimater.c **** 	}
 516              		.loc 1 113 148 discriminator 11 view .LVU166
 517 020c 4146     		mov	r1, r8
 518 020e 00E0     		b	.L12
 519              	.L36:
 520 0210 0121     		movs	r1, #1
 521              	.L12:
 113:Core/Src/phaseEstimater.c **** 	}
 522              		.loc 1 113 17 discriminator 14 view .LVU167
 523 0212 C9B2     		uxtb	r1, r1
 524              	.LVL29:
 113:Core/Src/phaseEstimater.c **** 	}
 525              		.loc 1 113 17 discriminator 14 view .LVU168
 526 0214 5FE7     		b	.L11
 527              	.LVL30:
 528              	.L37:
 113:Core/Src/phaseEstimater.c **** 	}
 529              		.loc 1 113 148 discriminator 11 view .LVU169
 530 0216 0121     		movs	r1, #1
 531 0218 FBE7     		b	.L12
 532              	.L38:
 533 021a 0121     		movs	r1, #1
 534 021c F9E7     		b	.L12
 535              	.L39:
 536 021e 0121     		movs	r1, #1
 537 0220 F7E7     		b	.L12
 538              	.L40:
 539 0222 0121     		movs	r1, #1
 540 0224 F5E7     		b	.L12
 541              	.LVL31:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 14


 542              	.L13:
 116:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 543              		.loc 1 116 46 discriminator 3 view .LVU170
 544 0226 314B     		ldr	r3, .L45+60
 545 0228 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 116:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 546              		.loc 1 116 44 discriminator 3 view .LVU171
 547 022a 002B     		cmp	r3, #0
 548 022c 7FF459AF 		bne	.L14
 117:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 549              		.loc 1 117 3 is_stmt 1 view .LVU172
 117:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 550              		.loc 1 117 13 is_stmt 0 view .LVU173
 551 0230 2C4A     		ldr	r2, .L45+52
 552 0232 1370     		strb	r3, [r2]
 118:Core/Src/phaseEstimater.c **** 		lock_HALL3=1;
 553              		.loc 1 118 3 is_stmt 1 view .LVU174
 118:Core/Src/phaseEstimater.c **** 		lock_HALL3=1;
 554              		.loc 1 118 13 is_stmt 0 view .LVU175
 555 0234 2C4A     		ldr	r2, .L45+56
 556 0236 1370     		strb	r3, [r2]
 119:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 557              		.loc 1 119 3 is_stmt 1 view .LVU176
 119:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 558              		.loc 1 119 13 is_stmt 0 view .LVU177
 559 0238 2C4B     		ldr	r3, .L45+60
 560 023a 0122     		movs	r2, #1
 561 023c 1A70     		strb	r2, [r3]
 120:Core/Src/phaseEstimater.c **** 	}
 562              		.loc 1 120 3 is_stmt 1 view .LVU178
 120:Core/Src/phaseEstimater.c **** 	}
 563              		.loc 1 120 148 is_stmt 0 view .LVU179
 564 023e 0028     		cmp	r0, #0
 565 0240 7FF451AF 		bne	.L15
 120:Core/Src/phaseEstimater.c **** 	}
 566              		.loc 1 120 42 discriminator 2 view .LVU180
 567 0244 002E     		cmp	r6, #0
 568 0246 7FF44EAF 		bne	.L15
 120:Core/Src/phaseEstimater.c **** 	}
 569              		.loc 1 120 69 discriminator 4 view .LVU181
 570 024a 002C     		cmp	r4, #0
 571 024c 7FF44BAF 		bne	.L15
 120:Core/Src/phaseEstimater.c **** 	}
 572              		.loc 1 120 95 discriminator 6 view .LVU182
 573 0250 002F     		cmp	r7, #0
 574 0252 7FF448AF 		bne	.L15
 120:Core/Src/phaseEstimater.c **** 	}
 575              		.loc 1 120 122 discriminator 8 view .LVU183
 576 0256 BCF1000F 		cmp	ip, #0
 577 025a 7FF444AF 		bne	.L15
 120:Core/Src/phaseEstimater.c **** 	}
 578              		.loc 1 120 148 discriminator 10 view .LVU184
 579 025e BEF1000F 		cmp	lr, #0
 580 0262 7FF440AF 		bne	.L15
 581 0266 88E7     		b	.L16
 582              	.LVL32:
 583              	.L17:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 15


 131:Core/Src/phaseEstimater.c **** 		}
 584              		.loc 1 131 4 is_stmt 1 view .LVU185
 131:Core/Src/phaseEstimater.c **** 		}
 585              		.loc 1 131 30 is_stmt 0 view .LVU186
 586 0268 D31A     		subs	r3, r2, r3
 587 026a 03F5B473 		add	r3, r3, #360
 131:Core/Src/phaseEstimater.c **** 		}
 588              		.loc 1 131 25 view .LVU187
 589 026e 1849     		ldr	r1, .L45+32
 590 0270 0B80     		strh	r3, [r1]	@ movhi
 591 0272 47E7     		b	.L18
 592              	.LVL33:
 593              	.L20:
 145:Core/Src/phaseEstimater.c **** 			}
 594              		.loc 1 145 5 is_stmt 1 view .LVU188
 145:Core/Src/phaseEstimater.c **** 			}
 595              		.loc 1 145 84 is_stmt 0 view .LVU189
 596 0274 9B1A     		subs	r3, r3, r2
 597 0276 03F5B473 		add	r3, r3, #360
 145:Core/Src/phaseEstimater.c **** 			}
 598              		.loc 1 145 39 view .LVU190
 599 027a 194A     		ldr	r2, .L45+48
 600 027c 22F81030 		strh	r3, [r2, r0, lsl #1]	@ movhi
 601 0280 79E7     		b	.L19
 602              	.LVL34:
 603              	.L22:
 604              	.LBB4:
 605              		.loc 1 153 20 is_stmt 1 discriminator 2 view .LVU191
 606 0282 0133     		adds	r3, r3, #1
 607              	.LVL35:
 608              	.L21:
 609              		.loc 1 153 16 discriminator 1 view .LVU192
 610 0284 072B     		cmp	r3, #7
 611 0286 07DC     		bgt	.L43
 154:Core/Src/phaseEstimater.c **** 		if(HallSector_Averages[i] >= 256) {
 612              		.loc 1 154 3 view .LVU193
 613              		.loc 1 154 25 is_stmt 0 view .LVU194
 614 0288 124C     		ldr	r4, .L45+36
 615 028a 34F81340 		ldrh	r4, [r4, r3, lsl #1]
 616              		.loc 1 154 5 view .LVU195
 617 028e FF2C     		cmp	r4, #255
 618 0290 F7D9     		bls	.L22
 155:Core/Src/phaseEstimater.c **** 			in_toleranz_count++;
 619              		.loc 1 155 4 is_stmt 1 view .LVU196
 620              		.loc 1 155 21 is_stmt 0 view .LVU197
 621 0292 0131     		adds	r1, r1, #1
 622              	.LVL36:
 623              		.loc 1 155 21 view .LVU198
 624 0294 89B2     		uxth	r1, r1
 625              	.LVL37:
 626              		.loc 1 155 21 view .LVU199
 627 0296 F4E7     		b	.L22
 628              	.L43:
 629              		.loc 1 155 21 view .LVU200
 630              	.LBE4:
 156:Core/Src/phaseEstimater.c **** 		}
 157:Core/Src/phaseEstimater.c **** 	}
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 16


 158:Core/Src/phaseEstimater.c **** 
 159:Core/Src/phaseEstimater.c **** 	if(in_toleranz_count==6){
 631              		.loc 1 159 2 is_stmt 1 view .LVU201
 632              		.loc 1 159 4 is_stmt 0 view .LVU202
 633 0298 0629     		cmp	r1, #6
 634 029a 50D0     		beq	.L41
  61:Core/Src/phaseEstimater.c **** 	uint8_t HallSector=0;
 635              		.loc 1 61 11 view .LVU203
 636 029c 0024     		movs	r4, #0
 637              	.LVL38:
 638              	.L25:
 160:Core/Src/phaseEstimater.c **** 		init_done=1;
 161:Core/Src/phaseEstimater.c **** 		for(int i=0;i<8;i++){
 162:Core/Src/phaseEstimater.c **** 			if(HallSector_Averages[i]<256){
 163:Core/Src/phaseEstimater.c **** 				HallSector_phase_offset[i]=255;	// Für ungültige Sektoren wird die Zahl 255 verwendet
 164:Core/Src/phaseEstimater.c **** 			}
 165:Core/Src/phaseEstimater.c **** 			else{
 166:Core/Src/phaseEstimater.c **** 				UART_transmit_string("Hallsektor: ");
 167:Core/Src/phaseEstimater.c **** 				UART_transmit_ui32(i);
 168:Core/Src/phaseEstimater.c **** 				UART_transmit_string(" Offset: ");
 169:Core/Src/phaseEstimater.c **** 				UART_transmit_ui32(HallSector_phase_offset[i]);
 170:Core/Src/phaseEstimater.c **** 				UART_transmit_string(" Phasespan: ");
 171:Core/Src/phaseEstimater.c **** 				UART_transmit_ui32(HallSector_phase_span[i]);
 172:Core/Src/phaseEstimater.c **** 				UART_transmit_crlf();
 173:Core/Src/phaseEstimater.c **** 			}
 174:Core/Src/phaseEstimater.c **** 		}
 175:Core/Src/phaseEstimater.c **** 	}
 176:Core/Src/phaseEstimater.c **** 
 177:Core/Src/phaseEstimater.c **** 	setVoltageVector(voltage_phase, 0, setpoint);
 639              		.loc 1 177 2 is_stmt 1 view .LVU204
 640 029e 2A46     		mov	r2, r5
 641 02a0 0021     		movs	r1, #0
 642 02a2 054B     		ldr	r3, .L45+8
 643 02a4 1888     		ldrh	r0, [r3]
 644 02a6 FFF7FEFF 		bl	setVoltageVector
 645              	.LVL39:
 178:Core/Src/phaseEstimater.c **** 
 179:Core/Src/phaseEstimater.c **** 
 180:Core/Src/phaseEstimater.c **** 	return init_done;
 646              		.loc 1 180 2 view .LVU205
 181:Core/Src/phaseEstimater.c **** }
 647              		.loc 1 181 1 is_stmt 0 view .LVU206
 648 02aa 2046     		mov	r0, r4
 649 02ac BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 650              	.LVL40:
 651              	.L46:
 652              		.loc 1 181 1 view .LVU207
 653              		.align	2
 654              	.L45:
 655 02b0 00000000 		.word	init.20
 656 02b4 00000000 		.word	htim6
 657 02b8 00000000 		.word	voltage_phase.19
 658 02bc 00000000 		.word	Motor
 659 02c0 00000000 		.word	HALL1.18
 660 02c4 00040048 		.word	1207960576
 661 02c8 00000000 		.word	HALL2.17
 662 02cc 00000000 		.word	phase_old.12
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 17


 663 02d0 00000000 		.word	time_between_sectors
 664 02d4 00000000 		.word	HallSector_Averages
 665 02d8 00000000 		.word	HallSector_phase_offset
 666 02dc 00000000 		.word	prev_Sector.11
 667 02e0 00000000 		.word	HallSector_phase_span
 668 02e4 00000000 		.word	lock_HALL1.15
 669 02e8 00000000 		.word	lock_HALL2.14
 670 02ec 00000000 		.word	lock_HALL3.13
 671 02f0 00000000 		.word	HALL3.16
 672              	.LVL41:
 673              	.L26:
 674              	.LBB5:
 166:Core/Src/phaseEstimater.c **** 				UART_transmit_ui32(i);
 675              		.loc 1 166 5 is_stmt 1 view .LVU208
 676 02f4 1448     		ldr	r0, .L47
 677 02f6 FFF7FEFF 		bl	UART_transmit_string
 678              	.LVL42:
 167:Core/Src/phaseEstimater.c **** 				UART_transmit_string(" Offset: ");
 679              		.loc 1 167 5 view .LVU209
 680 02fa 2046     		mov	r0, r4
 681 02fc FFF7FEFF 		bl	UART_transmit_ui32
 682              	.LVL43:
 168:Core/Src/phaseEstimater.c **** 				UART_transmit_ui32(HallSector_phase_offset[i]);
 683              		.loc 1 168 5 view .LVU210
 684 0300 1248     		ldr	r0, .L47+4
 685 0302 FFF7FEFF 		bl	UART_transmit_string
 686              	.LVL44:
 169:Core/Src/phaseEstimater.c **** 				UART_transmit_string(" Phasespan: ");
 687              		.loc 1 169 5 view .LVU211
 688 0306 124B     		ldr	r3, .L47+8
 689 0308 33F81400 		ldrh	r0, [r3, r4, lsl #1]
 690 030c FFF7FEFF 		bl	UART_transmit_ui32
 691              	.LVL45:
 170:Core/Src/phaseEstimater.c **** 				UART_transmit_ui32(HallSector_phase_span[i]);
 692              		.loc 1 170 5 view .LVU212
 693 0310 1048     		ldr	r0, .L47+12
 694 0312 FFF7FEFF 		bl	UART_transmit_string
 695              	.LVL46:
 171:Core/Src/phaseEstimater.c **** 				UART_transmit_crlf();
 696              		.loc 1 171 5 view .LVU213
 697 0316 104B     		ldr	r3, .L47+16
 698 0318 33F81400 		ldrh	r0, [r3, r4, lsl #1]
 699 031c FFF7FEFF 		bl	UART_transmit_ui32
 700              	.LVL47:
 172:Core/Src/phaseEstimater.c **** 			}
 701              		.loc 1 172 5 view .LVU214
 702 0320 FFF7FEFF 		bl	UART_transmit_crlf
 703              	.LVL48:
 704              	.L27:
 161:Core/Src/phaseEstimater.c **** 			if(HallSector_Averages[i]<256){
 705              		.loc 1 161 20 discriminator 2 view .LVU215
 706 0324 0134     		adds	r4, r4, #1
 707              	.LVL49:
 708              	.L24:
 161:Core/Src/phaseEstimater.c **** 			if(HallSector_Averages[i]<256){
 709              		.loc 1 161 16 discriminator 1 view .LVU216
 710 0326 072C     		cmp	r4, #7
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 18


 711 0328 0BDC     		bgt	.L44
 162:Core/Src/phaseEstimater.c **** 				HallSector_phase_offset[i]=255;	// Für ungültige Sektoren wird die Zahl 255 verwendet
 712              		.loc 1 162 4 view .LVU217
 162:Core/Src/phaseEstimater.c **** 				HallSector_phase_offset[i]=255;	// Für ungültige Sektoren wird die Zahl 255 verwendet
 713              		.loc 1 162 26 is_stmt 0 view .LVU218
 714 032a 0C4B     		ldr	r3, .L47+20
 715 032c 33F81430 		ldrh	r3, [r3, r4, lsl #1]
 162:Core/Src/phaseEstimater.c **** 				HallSector_phase_offset[i]=255;	// Für ungültige Sektoren wird die Zahl 255 verwendet
 716              		.loc 1 162 6 view .LVU219
 717 0330 FF2B     		cmp	r3, #255
 718 0332 DFD8     		bhi	.L26
 163:Core/Src/phaseEstimater.c **** 			}
 719              		.loc 1 163 5 is_stmt 1 view .LVU220
 163:Core/Src/phaseEstimater.c **** 			}
 720              		.loc 1 163 31 is_stmt 0 view .LVU221
 721 0334 064B     		ldr	r3, .L47+8
 722 0336 FF22     		movs	r2, #255
 723 0338 23F81420 		strh	r2, [r3, r4, lsl #1]	@ movhi
 724 033c F2E7     		b	.L27
 725              	.LVL50:
 726              	.L41:
 161:Core/Src/phaseEstimater.c **** 			if(HallSector_Averages[i]<256){
 727              		.loc 1 161 11 view .LVU222
 728 033e 0024     		movs	r4, #0
 729 0340 F1E7     		b	.L24
 730              	.LVL51:
 731              	.L44:
 161:Core/Src/phaseEstimater.c **** 			if(HallSector_Averages[i]<256){
 732              		.loc 1 161 11 view .LVU223
 733              	.LBE5:
 160:Core/Src/phaseEstimater.c **** 		for(int i=0;i<8;i++){
 734              		.loc 1 160 12 view .LVU224
 735 0342 0124     		movs	r4, #1
 736              	.LVL52:
 160:Core/Src/phaseEstimater.c **** 		for(int i=0;i<8;i++){
 737              		.loc 1 160 12 view .LVU225
 738 0344 ABE7     		b	.L25
 739              	.L48:
 740 0346 00BF     		.align	2
 741              	.L47:
 742 0348 00000000 		.word	.LC0
 743 034c 10000000 		.word	.LC1
 744 0350 00000000 		.word	HallSector_phase_offset
 745 0354 1C000000 		.word	.LC2
 746 0358 00000000 		.word	HallSector_phase_span
 747 035c 00000000 		.word	HallSector_Averages
 748              		.cfi_endproc
 749              	.LFE127:
 751              		.section	.text.estimate_rotor_phase,"ax",%progbits
 752              		.align	1
 753              		.global	estimate_rotor_phase
 754              		.syntax unified
 755              		.thumb
 756              		.thumb_func
 758              	estimate_rotor_phase:
 759              	.LVL53:
 760              	.LFB128:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 19


 182:Core/Src/phaseEstimater.c **** 
 183:Core/Src/phaseEstimater.c **** 
 184:Core/Src/phaseEstimater.c **** static uint8_t block_commutation_active=1;
 185:Core/Src/phaseEstimater.c **** static uint16_t Prev_Sector_times[8]={0};
 186:Core/Src/phaseEstimater.c **** 
 187:Core/Src/phaseEstimater.c **** void estimate_rotor_phase(motor_TypeDef* motor){
 761              		.loc 1 187 48 is_stmt 1 view -0
 762              		.cfi_startproc
 763              		@ args = 0, pretend = 0, frame = 0
 764              		@ frame_needed = 0, uses_anonymous_args = 0
 765              		.loc 1 187 48 is_stmt 0 view .LVU227
 766 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 767              	.LCFI1:
 768              		.cfi_def_cfa_offset 32
 769              		.cfi_offset 4, -32
 770              		.cfi_offset 5, -28
 771              		.cfi_offset 6, -24
 772              		.cfi_offset 7, -20
 773              		.cfi_offset 8, -16
 774              		.cfi_offset 9, -12
 775              		.cfi_offset 10, -8
 776              		.cfi_offset 14, -4
 777 0004 0546     		mov	r5, r0
 188:Core/Src/phaseEstimater.c **** 	static uint8_t init=0;
 778              		.loc 1 188 2 is_stmt 1 view .LVU228
 189:Core/Src/phaseEstimater.c **** 
 190:Core/Src/phaseEstimater.c **** 	if(!init){
 779              		.loc 1 190 2 view .LVU229
 780              		.loc 1 190 5 is_stmt 0 view .LVU230
 781 0006 AD4B     		ldr	r3, .L88
 782 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 783              		.loc 1 190 4 view .LVU231
 784 000a 002B     		cmp	r3, #0
 785 000c 00F0AD80 		beq	.L87
 786              	.LVL54:
 787              	.L50:
 191:Core/Src/phaseEstimater.c **** 		//init_phase_estimater();
 192:Core/Src/phaseEstimater.c **** 		MX_TIM6_Init();
 193:Core/Src/phaseEstimater.c **** 		init=1;
 194:Core/Src/phaseEstimater.c **** 	}
 195:Core/Src/phaseEstimater.c **** 
 196:Core/Src/phaseEstimater.c **** 
 197:Core/Src/phaseEstimater.c **** 	static uint8_t HallSector=0;
 788              		.loc 1 197 2 is_stmt 1 view .LVU232
 198:Core/Src/phaseEstimater.c **** 	uint16_t newSectorTime=0;
 789              		.loc 1 198 2 view .LVU233
 199:Core/Src/phaseEstimater.c **** 	static uint16_t SectorTime=0;
 790              		.loc 1 199 2 view .LVU234
 200:Core/Src/phaseEstimater.c **** 	static uint16_t PreviousHallSector=0;
 791              		.loc 1 200 2 view .LVU235
 201:Core/Src/phaseEstimater.c **** 	uint16_t CurrentSectorTime=SectorTIM.Instance->CNT;
 792              		.loc 1 201 2 view .LVU236
 793              		.loc 1 201 38 is_stmt 0 view .LVU237
 794 0010 AB4B     		ldr	r3, .L88+4
 795 0012 1B68     		ldr	r3, [r3]
 796              		.loc 1 201 47 view .LVU238
 797 0014 5C6A     		ldr	r4, [r3, #36]
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 20


 798              	.LVL55:
 202:Core/Src/phaseEstimater.c **** 	static prev_phase=0;
 799              		.loc 1 202 2 is_stmt 1 view .LVU239
 203:Core/Src/phaseEstimater.c **** 
 204:Core/Src/phaseEstimater.c **** 	
 205:Core/Src/phaseEstimater.c **** 	static uint8_t HALL1 = 0;
 800              		.loc 1 205 2 view .LVU240
 206:Core/Src/phaseEstimater.c **** 	static uint8_t HALL2 = 0;
 801              		.loc 1 206 2 view .LVU241
 207:Core/Src/phaseEstimater.c **** 	static uint8_t HALL3 = 0;
 802              		.loc 1 207 2 view .LVU242
 208:Core/Src/phaseEstimater.c **** 	
 209:Core/Src/phaseEstimater.c **** /*	static uint8_t HALL1_pinstate = 0;
 210:Core/Src/phaseEstimater.c **** 	static uint8_t HALL2_pinstate = 0;
 211:Core/Src/phaseEstimater.c **** 	static uint8_t HALL3_pinstate = 0;*/
 212:Core/Src/phaseEstimater.c **** 												 
 213:Core/Src/phaseEstimater.c ****  HALL1 = (HALL1<<1)|HAL_GPIO_ReadPin(HALL1_GPIO_Port,HALL1_Pin);
 803              		.loc 1 213 2 view .LVU243
 804              		.loc 1 213 20 is_stmt 0 view .LVU244
 805 0016 AB4F     		ldr	r7, .L88+8
 806 0018 3E78     		ldrb	r6, [r7]	@ zero_extendqisi2
 807              		.loc 1 213 21 view .LVU245
 808 001a DFF8B092 		ldr	r9, .L88+16
 809 001e 0421     		movs	r1, #4
 810 0020 4846     		mov	r0, r9
 811 0022 FFF7FEFF 		bl	HAL_GPIO_ReadPin
 812              	.LVL56:
 813              		.loc 1 213 20 discriminator 1 view .LVU246
 814 0026 40EA4600 		orr	r0, r0, r6, lsl #1
 815              		.loc 1 213 8 discriminator 1 view .LVU247
 816 002a 3870     		strb	r0, [r7]
 214:Core/Src/phaseEstimater.c ****  HALL2 = (HALL2<<1)|HAL_GPIO_ReadPin(HALL2_GPIO_Port,HALL2_Pin);
 817              		.loc 1 214 2 is_stmt 1 view .LVU248
 818              		.loc 1 214 20 is_stmt 0 view .LVU249
 819 002c A64E     		ldr	r6, .L88+12
 820 002e 96F80080 		ldrb	r8, [r6]	@ zero_extendqisi2
 821              		.loc 1 214 21 view .LVU250
 822 0032 4FF48061 		mov	r1, #1024
 823 0036 4846     		mov	r0, r9
 824 0038 FFF7FEFF 		bl	HAL_GPIO_ReadPin
 825              	.LVL57:
 826              		.loc 1 214 20 discriminator 1 view .LVU251
 827 003c 40EA4800 		orr	r0, r0, r8, lsl #1
 828              		.loc 1 214 8 discriminator 1 view .LVU252
 829 0040 3070     		strb	r0, [r6]
 215:Core/Src/phaseEstimater.c ****  HALL3 = (HALL3<<1)|HAL_GPIO_ReadPin(HALL3_GPIO_Port,HALL3_Pin);
 830              		.loc 1 215 2 is_stmt 1 view .LVU253
 831              		.loc 1 215 20 is_stmt 0 view .LVU254
 832 0042 DFF8B882 		ldr	r8, .L88+64
 833 0046 98F800A0 		ldrb	r10, [r8]	@ zero_extendqisi2
 834              		.loc 1 215 21 view .LVU255
 835 004a 4FF40061 		mov	r1, #2048
 836 004e 4846     		mov	r0, r9
 837 0050 FFF7FEFF 		bl	HAL_GPIO_ReadPin
 838              	.LVL58:
 839              		.loc 1 215 20 discriminator 1 view .LVU256
 840 0054 40EA4A03 		orr	r3, r0, r10, lsl #1
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 21


 841 0058 DBB2     		uxtb	r3, r3
 842              		.loc 1 215 8 discriminator 1 view .LVU257
 843 005a 88F80030 		strb	r3, [r8]
 216:Core/Src/phaseEstimater.c **** 
 217:Core/Src/phaseEstimater.c **** 	uint8_t HALL1_rising_edge =		  (HALL1&0x0F)==3;
 844              		.loc 1 217 2 is_stmt 1 view .LVU258
 845              		.loc 1 217 39 is_stmt 0 view .LVU259
 846 005e 3978     		ldrb	r1, [r7]	@ zero_extendqisi2
 847 0060 01F00F01 		and	r1, r1, #15
 848              		.loc 1 217 45 view .LVU260
 849 0064 0329     		cmp	r1, #3
 850 0066 14BF     		ite	ne
 851 0068 0020     		movne	r0, #0
 852 006a 0120     		moveq	r0, #1
 853              	.LVL59:
 218:Core/Src/phaseEstimater.c **** 	uint8_t HALL1_falling_edge=	    (HALL1&0x0F)==14;
 854              		.loc 1 218 2 is_stmt 1 view .LVU261
 855              		.loc 1 218 46 is_stmt 0 view .LVU262
 856 006c 0E29     		cmp	r1, #14
 857 006e 14BF     		ite	ne
 858 0070 0027     		movne	r7, #0
 859 0072 0127     		moveq	r7, #1
 860              	.LVL60:
 219:Core/Src/phaseEstimater.c **** 	uint8_t HALL2_rising_edge =		  (HALL2&0x0F)==3;
 861              		.loc 1 219 2 is_stmt 1 view .LVU263
 862              		.loc 1 219 39 is_stmt 0 view .LVU264
 863 0074 3278     		ldrb	r2, [r6]	@ zero_extendqisi2
 864 0076 02F00F02 		and	r2, r2, #15
 865              		.loc 1 219 45 view .LVU265
 866 007a 032A     		cmp	r2, #3
 867 007c 14BF     		ite	ne
 868 007e 0026     		movne	r6, #0
 869 0080 0126     		moveq	r6, #1
 870              	.LVL61:
 220:Core/Src/phaseEstimater.c **** 	uint8_t HALL2_falling_edge=	    (HALL2&0x0F)==14;
 871              		.loc 1 220 2 is_stmt 1 view .LVU266
 872              		.loc 1 220 46 is_stmt 0 view .LVU267
 873 0082 0E2A     		cmp	r2, #14
 874 0084 14BF     		ite	ne
 875 0086 4FF0000C 		movne	ip, #0
 876 008a 4FF0010C 		moveq	ip, #1
 877              	.LVL62:
 221:Core/Src/phaseEstimater.c **** 	uint8_t HALL3_rising_edge =		  (HALL3&0x0F)==3;
 878              		.loc 1 221 2 is_stmt 1 view .LVU268
 879 008e 03F00F03 		and	r3, r3, #15
 880              		.loc 1 221 45 is_stmt 0 view .LVU269
 881 0092 032B     		cmp	r3, #3
 882 0094 14BF     		ite	ne
 883 0096 4FF0000E 		movne	lr, #0
 884 009a 4FF0010E 		moveq	lr, #1
 885              	.LVL63:
 222:Core/Src/phaseEstimater.c **** 	uint8_t HALL3_falling_edge=	    (HALL3&0x0F)==14;
 886              		.loc 1 222 2 is_stmt 1 view .LVU270
 887              		.loc 1 222 46 is_stmt 0 view .LVU271
 888 009e 0E2B     		cmp	r3, #14
 889 00a0 14BF     		ite	ne
 890 00a2 4FF00008 		movne	r8, #0
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 22


 891 00a6 4FF00108 		moveq	r8, #1
 892              	.LVL64:
 223:Core/Src/phaseEstimater.c **** 	
 224:Core/Src/phaseEstimater.c **** 	uint8_t valid_signals = 0;// (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_ed
 893              		.loc 1 224 2 is_stmt 1 view .LVU272
 225:Core/Src/phaseEstimater.c **** 
 226:Core/Src/phaseEstimater.c **** 	static uint8_t lock_HALL1=0;
 894              		.loc 1 226 2 view .LVU273
 227:Core/Src/phaseEstimater.c **** 	static uint8_t lock_HALL2=0;
 895              		.loc 1 227 2 view .LVU274
 228:Core/Src/phaseEstimater.c **** 	static uint8_t lock_HALL3=0;
 896              		.loc 1 228 2 view .LVU275
 229:Core/Src/phaseEstimater.c **** 
 230:Core/Src/phaseEstimater.c **** 	//Bei einer Flanke wenn diese nicht gerade gelockt ist
 231:Core/Src/phaseEstimater.c **** 	if((HALL1_falling_edge||HALL1_rising_edge)&&!lock_HALL1){
 897              		.loc 1 231 2 view .LVU276
 898              		.loc 1 231 4 is_stmt 0 view .LVU277
 899 00aa 0E29     		cmp	r1, #14
 900 00ac 63D0     		beq	.L51
 901              		.loc 1 231 24 discriminator 2 view .LVU278
 902 00ae 0329     		cmp	r1, #3
 903 00b0 61D0     		beq	.L51
 224:Core/Src/phaseEstimater.c **** 
 904              		.loc 1 224 10 view .LVU279
 905 00b2 0021     		movs	r1, #0
 906              	.LVL65:
 907              	.L52:
 232:Core/Src/phaseEstimater.c **** 		lock_HALL1=1;
 233:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 234:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 235:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 236:Core/Src/phaseEstimater.c **** 	}
 237:Core/Src/phaseEstimater.c **** 	//Bei einer Flanke wenn diese nicht gerade gelockt ist
 238:Core/Src/phaseEstimater.c **** 	if((HALL2_falling_edge||HALL2_rising_edge)&&!lock_HALL2){
 908              		.loc 1 238 2 is_stmt 1 view .LVU280
 909              		.loc 1 238 4 is_stmt 0 view .LVU281
 910 00b4 0E2A     		cmp	r2, #14
 911 00b6 00F08C80 		beq	.L54
 912              		.loc 1 238 24 discriminator 2 view .LVU282
 913 00ba 032A     		cmp	r2, #3
 914 00bc 00F08980 		beq	.L54
 915              	.L55:
 239:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 240:Core/Src/phaseEstimater.c **** 		lock_HALL2=1;
 241:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 242:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 243:Core/Src/phaseEstimater.c **** 	}
 244:Core/Src/phaseEstimater.c **** 	//Bei einer Flanke wenn diese nicht gerade gelockt ist
 245:Core/Src/phaseEstimater.c **** 	if((HALL3_falling_edge||HALL3_rising_edge)&&!lock_HALL3){
 916              		.loc 1 245 2 is_stmt 1 view .LVU283
 917              		.loc 1 245 4 is_stmt 0 view .LVU284
 918 00c0 0E2B     		cmp	r3, #14
 919 00c2 00F0AF80 		beq	.L57
 920              		.loc 1 245 24 discriminator 2 view .LVU285
 921 00c6 032B     		cmp	r3, #3
 922 00c8 00F0AC80 		beq	.L57
 923              	.L58:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 23


 246:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 247:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 248:Core/Src/phaseEstimater.c **** 		lock_HALL3=1;
 249:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 250:Core/Src/phaseEstimater.c **** 	}
 251:Core/Src/phaseEstimater.c **** 
 252:Core/Src/phaseEstimater.c **** 	
 253:Core/Src/phaseEstimater.c **** 	if(valid_signals){
 924              		.loc 1 253 2 is_stmt 1 view .LVU286
 925              		.loc 1 253 4 is_stmt 0 view .LVU287
 926 00cc B1B1     		cbz	r1, .L60
 927              	.L59:
 928              	.LVL66:
 254:Core/Src/phaseEstimater.c **** 		HallSector = (HAL_GPIO_ReadPin(HALL3_GPIO_Port,HALL3_Pin)<<2)|(HAL_GPIO_ReadPin(HALL2_GPIO_Port,H
 929              		.loc 1 254 3 is_stmt 1 view .LVU288
 930              		.loc 1 254 17 is_stmt 0 view .LVU289
 931 00ce 7F4F     		ldr	r7, .L88+16
 932              	.LVL67:
 933              		.loc 1 254 17 view .LVU290
 934 00d0 4FF40061 		mov	r1, #2048
 935 00d4 3846     		mov	r0, r7
 936              	.LVL68:
 937              		.loc 1 254 17 view .LVU291
 938 00d6 FFF7FEFF 		bl	HAL_GPIO_ReadPin
 939              	.LVL69:
 940              		.loc 1 254 17 view .LVU292
 941 00da 8046     		mov	r8, r0
 942              	.LVL70:
 943              		.loc 1 254 66 discriminator 1 view .LVU293
 944 00dc 4FF48061 		mov	r1, #1024
 945 00e0 3846     		mov	r0, r7
 946 00e2 FFF7FEFF 		bl	HAL_GPIO_ReadPin
 947              	.LVL71:
 948              		.loc 1 254 64 discriminator 2 view .LVU294
 949 00e6 4600     		lsls	r6, r0, #1
 950              	.LVL72:
 951              		.loc 1 254 64 discriminator 2 view .LVU295
 952 00e8 46EA8806 		orr	r6, r6, r8, lsl #2
 953 00ec 76B2     		sxtb	r6, r6
 954              		.loc 1 254 115 discriminator 2 view .LVU296
 955 00ee 0421     		movs	r1, #4
 956 00f0 3846     		mov	r0, r7
 957 00f2 FFF7FEFF 		bl	HAL_GPIO_ReadPin
 958              	.LVL73:
 959              		.loc 1 254 113 discriminator 3 view .LVU297
 960 00f6 3043     		orrs	r0, r0, r6
 961              		.loc 1 254 14 discriminator 3 view .LVU298
 962 00f8 754B     		ldr	r3, .L88+20
 963 00fa 1870     		strb	r0, [r3]
 964              	.L60:
 255:Core/Src/phaseEstimater.c **** 	}
 256:Core/Src/phaseEstimater.c **** 	
 257:Core/Src/phaseEstimater.c **** 	
 258:Core/Src/phaseEstimater.c **** 	uint16_t offset= HallSector_phase_offset[HallSector];
 965              		.loc 1 258 2 is_stmt 1 view .LVU299
 966              		.loc 1 258 42 is_stmt 0 view .LVU300
 967 00fc 744B     		ldr	r3, .L88+20
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 24


 968 00fe 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 969              		.loc 1 258 11 view .LVU301
 970 0100 744B     		ldr	r3, .L88+24
 971 0102 33F81210 		ldrh	r1, [r3, r2, lsl #1]
 972              	.LVL74:
 259:Core/Src/phaseEstimater.c **** 	
 260:Core/Src/phaseEstimater.c **** 	if(offset!=255){																				// valid Sector
 973              		.loc 1 260 2 is_stmt 1 view .LVU302
 974              		.loc 1 260 4 is_stmt 0 view .LVU303
 975 0106 FF29     		cmp	r1, #255
 976 0108 00F0FA80 		beq	.L61
 261:Core/Src/phaseEstimater.c **** 		if(HallSector!=PreviousHallSector){										// Sector changed
 977              		.loc 1 261 3 is_stmt 1 view .LVU304
 978              		.loc 1 261 16 is_stmt 0 view .LVU305
 979 010c 724B     		ldr	r3, .L88+28
 980 010e 1B88     		ldrh	r3, [r3]
 981              		.loc 1 261 5 view .LVU306
 982 0110 9A42     		cmp	r2, r3
 983 0112 0ED0     		beq	.L62
 262:Core/Src/phaseEstimater.c **** 			if(__HAL_TIM_GET_FLAG(&SectorTIM,TIM_FLAG_UPDATE)){	// Timer overflowed
 984              		.loc 1 262 4 is_stmt 1 view .LVU307
 985              		.loc 1 262 7 is_stmt 0 view .LVU308
 986 0114 6A48     		ldr	r0, .L88+4
 987 0116 0068     		ldr	r0, [r0]
 988 0118 0669     		ldr	r6, [r0, #16]
 989              		.loc 1 262 6 view .LVU309
 990 011a 16F0010F 		tst	r6, #1
 991 011e 00F0A380 		beq	.L63
 263:Core/Src/phaseEstimater.c **** 				__HAL_TIM_CLEAR_FLAG(&SectorTIM,TIM_FLAG_UPDATE);
 992              		.loc 1 263 5 is_stmt 1 view .LVU310
 993 0122 6FF00103 		mvn	r3, #1
 994 0126 0361     		str	r3, [r0, #16]
 264:Core/Src/phaseEstimater.c **** 				block_commutation_active=1;
 995              		.loc 1 264 5 view .LVU311
 996              		.loc 1 264 29 is_stmt 0 view .LVU312
 997 0128 6C4B     		ldr	r3, .L88+32
 998 012a 0126     		movs	r6, #1
 999 012c 1E70     		strb	r6, [r3]
 1000              	.L64:
 265:Core/Src/phaseEstimater.c **** 			}
 266:Core/Src/phaseEstimater.c **** 			else{
 267:Core/Src/phaseEstimater.c **** 				// inhibit false sectorchanges due to artefacts in the Hall signal.
 268:Core/Src/phaseEstimater.c **** 				
 269:Core/Src/phaseEstimater.c **** 				// if the sector changes to quickly (artefacts) then don`t reset the hall sector time;
 270:Core/Src/phaseEstimater.c **** 				if(SectorTime >= (Prev_Sector_times[PreviousHallSector]>>1)){
 271:Core/Src/phaseEstimater.c **** 				SectorTime = SectorTIM.Instance->CNT;							  // Secure the Sector Time
 272:Core/Src/phaseEstimater.c **** 				Prev_Sector_times[PreviousHallSector] = SectorTime;				// The Measured Sector Time is form the 
 273:Core/Src/phaseEstimater.c **** 				block_commutation_active=0;
 274:Core/Src/phaseEstimater.c **** 				}
 275:Core/Src/phaseEstimater.c **** 			}
 276:Core/Src/phaseEstimater.c **** 			SectorTIM.Instance->CNT=0;													// reset counter
 1001              		.loc 1 276 4 is_stmt 1 view .LVU313
 1002              		.loc 1 276 27 is_stmt 0 view .LVU314
 1003 012e 0023     		movs	r3, #0
 1004 0130 4362     		str	r3, [r0, #36]
 1005              	.L62:
 277:Core/Src/phaseEstimater.c **** 			//HAL_GPIO_TogglePin(GPIOA, GPIO_PIN_5);
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 25


 278:Core/Src/phaseEstimater.c **** 		}
 279:Core/Src/phaseEstimater.c **** 		
 280:Core/Src/phaseEstimater.c **** 		
 281:Core/Src/phaseEstimater.c **** 		if(block_commutation_active){
 1006              		.loc 1 281 3 is_stmt 1 view .LVU315
 1007              		.loc 1 281 6 is_stmt 0 view .LVU316
 1008 0132 6A4B     		ldr	r3, .L88+32
 1009 0134 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1010              		.loc 1 281 5 view .LVU317
 1011 0136 002B     		cmp	r3, #0
 1012 0138 00F0AA80 		beq	.L65
 282:Core/Src/phaseEstimater.c **** 			motor->rotorphase = offset;
 1013              		.loc 1 282 4 is_stmt 1 view .LVU318
 1014              		.loc 1 282 22 is_stmt 0 view .LVU319
 1015 013c 2980     		strh	r1, [r5]	@ movhi
 1016              	.LVL75:
 1017              	.L66:
 283:Core/Src/phaseEstimater.c **** 		}
 284:Core/Src/phaseEstimater.c **** 		else{
 285:Core/Src/phaseEstimater.c **** 			motor->rotorphase= offset + (CurrentSectorTime*HallSector_phase_span[HallSector])/Prev_Sector_ti
 286:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 287:Core/Src/phaseEstimater.c **** 		}
 288:Core/Src/phaseEstimater.c **** 		PreviousHallSector=HallSector;
 1018              		.loc 1 288 3 is_stmt 1 view .LVU320
 1019              		.loc 1 288 21 is_stmt 0 view .LVU321
 1020 013e 664B     		ldr	r3, .L88+28
 1021 0140 1A80     		strh	r2, [r3]	@ movhi
 1022              	.L67:
 289:Core/Src/phaseEstimater.c **** 	}
 290:Core/Src/phaseEstimater.c **** 	else{
 291:Core/Src/phaseEstimater.c **** 		offset = HallSector_phase_offset[PreviousHallSector];
 292:Core/Src/phaseEstimater.c **** 		if(block_commutation_active){
 293:Core/Src/phaseEstimater.c **** 			motor->rotorphase = offset;
 294:Core/Src/phaseEstimater.c **** 		}
 295:Core/Src/phaseEstimater.c **** 		else{
 296:Core/Src/phaseEstimater.c **** 			motor->rotorphase= offset + (CurrentSectorTime*HallSector_phase_span[HallSector])/Prev_Sector_ti
 297:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 298:Core/Src/phaseEstimater.c **** 		}
 299:Core/Src/phaseEstimater.c **** 	}
 300:Core/Src/phaseEstimater.c **** 	
 301:Core/Src/phaseEstimater.c **** 	// Correct for glitches in the rotorphase
 302:Core/Src/phaseEstimater.c **** 
 303:Core/Src/phaseEstimater.c **** 	int16_t rate_of_change = 0;
 1023              		.loc 1 303 2 is_stmt 1 view .LVU322
 1024              	.LVL76:
 304:Core/Src/phaseEstimater.c **** 
 305:Core/Src/phaseEstimater.c **** 	// When the rotorphase passes 360° correct for it
 306:Core/Src/phaseEstimater.c **** 	if(motor->rotorphase-prev_phase<300){
 1025              		.loc 1 306 2 view .LVU323
 1026              		.loc 1 306 10 is_stmt 0 view .LVU324
 1027 0142 2A88     		ldrh	r2, [r5]
 1028              		.loc 1 306 22 view .LVU325
 1029 0144 664B     		ldr	r3, .L88+36
 1030 0146 1968     		ldr	r1, [r3]
 1031              	.LVL77:
 1032              		.loc 1 306 22 view .LVU326
 1033 0148 531A     		subs	r3, r2, r1
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 26


 1034              		.loc 1 306 4 view .LVU327
 1035 014a B3F5967F 		cmp	r3, #300
 1036 014e 80F2F780 		bge	.L69
 307:Core/Src/phaseEstimater.c **** 		rate_of_change = (motor->rotorphase+360)-prev_phase;
 1037              		.loc 1 307 3 is_stmt 1 view .LVU328
 1038              		.loc 1 307 43 is_stmt 0 view .LVU329
 1039 0152 03F5B473 		add	r3, r3, #360
 1040              		.loc 1 307 18 view .LVU330
 1041 0156 1BB2     		sxth	r3, r3
 1042              	.LVL78:
 1043              	.L70:
 308:Core/Src/phaseEstimater.c **** 	}
 309:Core/Src/phaseEstimater.c **** 	else if(motor->rotorphase - prev_phase >300){
 310:Core/Src/phaseEstimater.c **** 		rate_of_change = (motor->rotorphase-360)-prev_phase;
 311:Core/Src/phaseEstimater.c **** 	}
 312:Core/Src/phaseEstimater.c **** 	else{
 313:Core/Src/phaseEstimater.c **** 		rate_of_change = motor->rotorphase-prev_phase;
 314:Core/Src/phaseEstimater.c **** 	}
 315:Core/Src/phaseEstimater.c **** 
 316:Core/Src/phaseEstimater.c **** 	if(rate_of_change>5) motor->corr_rotor_phase = prev_phase + 5;
 1044              		.loc 1 316 2 is_stmt 1 view .LVU331
 1045              		.loc 1 316 4 is_stmt 0 view .LVU332
 1046 0158 052B     		cmp	r3, #5
 1047 015a 40F3FC80 		ble	.L72
 1048              		.loc 1 316 23 is_stmt 1 discriminator 1 view .LVU333
 1049              		.loc 1 316 60 is_stmt 0 discriminator 1 view .LVU334
 1050 015e 0531     		adds	r1, r1, #5
 1051              		.loc 1 316 47 discriminator 1 view .LVU335
 1052 0160 6980     		strh	r1, [r5, #2]	@ movhi
 1053              	.L73:
 317:Core/Src/phaseEstimater.c **** 	else{ motor->corr_rotor_phase=motor->rotorphase;}
 318:Core/Src/phaseEstimater.c **** 
 319:Core/Src/phaseEstimater.c **** 	prev_phase = motor->rotorphase;
 1054              		.loc 1 319 2 is_stmt 1 view .LVU336
 1055              		.loc 1 319 13 is_stmt 0 view .LVU337
 1056 0162 5F4B     		ldr	r3, .L88+36
 1057              	.LVL79:
 1058              		.loc 1 319 13 view .LVU338
 1059 0164 1A60     		str	r2, [r3]
 320:Core/Src/phaseEstimater.c **** }
 1060              		.loc 1 320 1 view .LVU339
 1061 0166 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1062              	.LVL80:
 1063              	.L87:
 192:Core/Src/phaseEstimater.c **** 		init=1;
 1064              		.loc 1 192 3 is_stmt 1 view .LVU340
 1065 016a FFF7FEFF 		bl	MX_TIM6_Init
 1066              	.LVL81:
 193:Core/Src/phaseEstimater.c **** 	}
 1067              		.loc 1 193 3 view .LVU341
 193:Core/Src/phaseEstimater.c **** 	}
 1068              		.loc 1 193 7 is_stmt 0 view .LVU342
 1069 016e 534B     		ldr	r3, .L88
 1070 0170 0122     		movs	r2, #1
 1071 0172 1A70     		strb	r2, [r3]
 1072 0174 4CE7     		b	.L50
 1073              	.LVL82:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 27


 1074              	.L51:
 231:Core/Src/phaseEstimater.c **** 		lock_HALL1=1;
 1075              		.loc 1 231 46 discriminator 3 view .LVU343
 1076 0176 5B49     		ldr	r1, .L88+40
 1077 0178 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
 231:Core/Src/phaseEstimater.c **** 		lock_HALL1=1;
 1078              		.loc 1 231 44 discriminator 3 view .LVU344
 1079 017a 41BB     		cbnz	r1, .L75
 232:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 1080              		.loc 1 232 3 is_stmt 1 view .LVU345
 232:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 1081              		.loc 1 232 13 is_stmt 0 view .LVU346
 1082 017c 5949     		ldr	r1, .L88+40
 1083 017e 4FF00109 		mov	r9, #1
 1084 0182 81F80090 		strb	r9, [r1]
 233:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 1085              		.loc 1 233 3 is_stmt 1 view .LVU347
 233:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 1086              		.loc 1 233 13 is_stmt 0 view .LVU348
 1087 0186 0021     		movs	r1, #0
 1088 0188 DFF85C91 		ldr	r9, .L88+44
 1089 018c 89F80010 		strb	r1, [r9]
 234:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 1090              		.loc 1 234 3 is_stmt 1 view .LVU349
 234:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 1091              		.loc 1 234 13 is_stmt 0 view .LVU350
 1092 0190 DFF85891 		ldr	r9, .L88+48
 1093 0194 89F80010 		strb	r1, [r9]
 235:Core/Src/phaseEstimater.c **** 	}
 1094              		.loc 1 235 3 is_stmt 1 view .LVU351
 235:Core/Src/phaseEstimater.c **** 	}
 1095              		.loc 1 235 148 is_stmt 0 view .LVU352
 1096 0198 70B9     		cbnz	r0, .L76
 235:Core/Src/phaseEstimater.c **** 	}
 1097              		.loc 1 235 42 discriminator 2 view .LVU353
 1098 019a 87B9     		cbnz	r7, .L77
 235:Core/Src/phaseEstimater.c **** 	}
 1099              		.loc 1 235 69 discriminator 4 view .LVU354
 1100 019c 8EB9     		cbnz	r6, .L78
 235:Core/Src/phaseEstimater.c **** 	}
 1101              		.loc 1 235 95 discriminator 6 view .LVU355
 1102 019e BCF1000F 		cmp	ip, #0
 1103 01a2 10D1     		bne	.L79
 235:Core/Src/phaseEstimater.c **** 	}
 1104              		.loc 1 235 122 discriminator 8 view .LVU356
 1105 01a4 BEF1000F 		cmp	lr, #0
 1106 01a8 0FD1     		bne	.L80
 235:Core/Src/phaseEstimater.c **** 	}
 1107              		.loc 1 235 148 discriminator 10 view .LVU357
 1108 01aa 4FEA8801 		lsl	r1, r8, #2
 1109 01ae B8F1000F 		cmp	r8, #0
 1110 01b2 02D0     		beq	.L53
 235:Core/Src/phaseEstimater.c **** 	}
 1111              		.loc 1 235 148 discriminator 11 view .LVU358
 1112 01b4 0121     		movs	r1, #1
 1113 01b6 00E0     		b	.L53
 1114              	.L76:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 28


 1115 01b8 0121     		movs	r1, #1
 1116              	.L53:
 235:Core/Src/phaseEstimater.c **** 	}
 1117              		.loc 1 235 17 discriminator 14 view .LVU359
 1118 01ba C9B2     		uxtb	r1, r1
 1119              	.LVL83:
 235:Core/Src/phaseEstimater.c **** 	}
 1120              		.loc 1 235 17 discriminator 14 view .LVU360
 1121 01bc 7AE7     		b	.L52
 1122              	.LVL84:
 1123              	.L77:
 235:Core/Src/phaseEstimater.c **** 	}
 1124              		.loc 1 235 148 discriminator 11 view .LVU361
 1125 01be 0121     		movs	r1, #1
 1126 01c0 FBE7     		b	.L53
 1127              	.L78:
 1128 01c2 0121     		movs	r1, #1
 1129 01c4 F9E7     		b	.L53
 1130              	.L79:
 1131 01c6 0121     		movs	r1, #1
 1132 01c8 F7E7     		b	.L53
 1133              	.L80:
 1134 01ca 0121     		movs	r1, #1
 1135 01cc F5E7     		b	.L53
 1136              	.L75:
 224:Core/Src/phaseEstimater.c **** 
 1137              		.loc 1 224 10 view .LVU362
 1138 01ce 0021     		movs	r1, #0
 1139 01d0 70E7     		b	.L52
 1140              	.LVL85:
 1141              	.L54:
 238:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 1142              		.loc 1 238 46 discriminator 3 view .LVU363
 1143 01d2 454A     		ldr	r2, .L88+44
 1144 01d4 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 238:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 1145              		.loc 1 238 44 discriminator 3 view .LVU364
 1146 01d6 002A     		cmp	r2, #0
 1147 01d8 7FF472AF 		bne	.L55
 239:Core/Src/phaseEstimater.c **** 		lock_HALL2=1;
 1148              		.loc 1 239 3 is_stmt 1 view .LVU365
 239:Core/Src/phaseEstimater.c **** 		lock_HALL2=1;
 1149              		.loc 1 239 13 is_stmt 0 view .LVU366
 1150 01dc 4149     		ldr	r1, .L88+40
 1151              	.LVL86:
 239:Core/Src/phaseEstimater.c **** 		lock_HALL2=1;
 1152              		.loc 1 239 13 view .LVU367
 1153 01de 0A70     		strb	r2, [r1]
 240:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 1154              		.loc 1 240 3 is_stmt 1 view .LVU368
 240:Core/Src/phaseEstimater.c **** 		lock_HALL3=0;
 1155              		.loc 1 240 13 is_stmt 0 view .LVU369
 1156 01e0 4149     		ldr	r1, .L88+44
 1157 01e2 4FF00109 		mov	r9, #1
 1158 01e6 81F80090 		strb	r9, [r1]
 241:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 1159              		.loc 1 241 3 is_stmt 1 view .LVU370
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 29


 241:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 1160              		.loc 1 241 13 is_stmt 0 view .LVU371
 1161 01ea 4049     		ldr	r1, .L88+48
 1162 01ec 0A70     		strb	r2, [r1]
 242:Core/Src/phaseEstimater.c **** 	}
 1163              		.loc 1 242 3 is_stmt 1 view .LVU372
 242:Core/Src/phaseEstimater.c **** 	}
 1164              		.loc 1 242 148 is_stmt 0 view .LVU373
 1165 01ee 70B9     		cbnz	r0, .L81
 242:Core/Src/phaseEstimater.c **** 	}
 1166              		.loc 1 242 42 discriminator 2 view .LVU374
 1167 01f0 87B9     		cbnz	r7, .L82
 242:Core/Src/phaseEstimater.c **** 	}
 1168              		.loc 1 242 69 discriminator 4 view .LVU375
 1169 01f2 8EB9     		cbnz	r6, .L83
 242:Core/Src/phaseEstimater.c **** 	}
 1170              		.loc 1 242 95 discriminator 6 view .LVU376
 1171 01f4 BCF1000F 		cmp	ip, #0
 1172 01f8 10D1     		bne	.L84
 242:Core/Src/phaseEstimater.c **** 	}
 1173              		.loc 1 242 122 discriminator 8 view .LVU377
 1174 01fa BEF1000F 		cmp	lr, #0
 1175 01fe 0FD1     		bne	.L85
 242:Core/Src/phaseEstimater.c **** 	}
 1176              		.loc 1 242 148 discriminator 10 view .LVU378
 1177 0200 4FEA8801 		lsl	r1, r8, #2
 1178 0204 B8F1000F 		cmp	r8, #0
 1179 0208 02D0     		beq	.L56
 242:Core/Src/phaseEstimater.c **** 	}
 1180              		.loc 1 242 148 discriminator 11 view .LVU379
 1181 020a 4946     		mov	r1, r9
 1182 020c 00E0     		b	.L56
 1183              	.L81:
 1184 020e 0121     		movs	r1, #1
 1185              	.L56:
 242:Core/Src/phaseEstimater.c **** 	}
 1186              		.loc 1 242 17 discriminator 14 view .LVU380
 1187 0210 C9B2     		uxtb	r1, r1
 1188              	.LVL87:
 242:Core/Src/phaseEstimater.c **** 	}
 1189              		.loc 1 242 17 discriminator 14 view .LVU381
 1190 0212 55E7     		b	.L55
 1191              	.LVL88:
 1192              	.L82:
 242:Core/Src/phaseEstimater.c **** 	}
 1193              		.loc 1 242 148 discriminator 11 view .LVU382
 1194 0214 0121     		movs	r1, #1
 1195 0216 FBE7     		b	.L56
 1196              	.L83:
 1197 0218 0121     		movs	r1, #1
 1198 021a F9E7     		b	.L56
 1199              	.L84:
 1200 021c 0121     		movs	r1, #1
 1201 021e F7E7     		b	.L56
 1202              	.L85:
 1203 0220 0121     		movs	r1, #1
 1204 0222 F5E7     		b	.L56
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 30


 1205              	.LVL89:
 1206              	.L57:
 245:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 1207              		.loc 1 245 46 discriminator 3 view .LVU383
 1208 0224 314B     		ldr	r3, .L88+48
 1209 0226 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 245:Core/Src/phaseEstimater.c **** 		lock_HALL1=0;
 1210              		.loc 1 245 44 discriminator 3 view .LVU384
 1211 0228 002B     		cmp	r3, #0
 1212 022a 7FF44FAF 		bne	.L58
 246:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 1213              		.loc 1 246 3 is_stmt 1 view .LVU385
 246:Core/Src/phaseEstimater.c **** 		lock_HALL2=0;
 1214              		.loc 1 246 13 is_stmt 0 view .LVU386
 1215 022e 2D4A     		ldr	r2, .L88+40
 1216 0230 1370     		strb	r3, [r2]
 247:Core/Src/phaseEstimater.c **** 		lock_HALL3=1;
 1217              		.loc 1 247 3 is_stmt 1 view .LVU387
 247:Core/Src/phaseEstimater.c **** 		lock_HALL3=1;
 1218              		.loc 1 247 13 is_stmt 0 view .LVU388
 1219 0232 2D4A     		ldr	r2, .L88+44
 1220 0234 1370     		strb	r3, [r2]
 248:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 1221              		.loc 1 248 3 is_stmt 1 view .LVU389
 248:Core/Src/phaseEstimater.c **** 		valid_signals = (HALL1_rising_edge<<7) || (HALL1_falling_edge<<6) || (HALL2_rising_edge<<5) || (H
 1222              		.loc 1 248 13 is_stmt 0 view .LVU390
 1223 0236 2D4B     		ldr	r3, .L88+48
 1224 0238 0122     		movs	r2, #1
 1225 023a 1A70     		strb	r2, [r3]
 249:Core/Src/phaseEstimater.c **** 	}
 1226              		.loc 1 249 3 is_stmt 1 view .LVU391
 249:Core/Src/phaseEstimater.c **** 	}
 1227              		.loc 1 249 148 is_stmt 0 view .LVU392
 1228 023c 0028     		cmp	r0, #0
 1229 023e 7FF446AF 		bne	.L59
 249:Core/Src/phaseEstimater.c **** 	}
 1230              		.loc 1 249 42 discriminator 2 view .LVU393
 1231 0242 002F     		cmp	r7, #0
 1232 0244 7FF443AF 		bne	.L59
 249:Core/Src/phaseEstimater.c **** 	}
 1233              		.loc 1 249 69 discriminator 4 view .LVU394
 1234 0248 002E     		cmp	r6, #0
 1235 024a 7FF440AF 		bne	.L59
 249:Core/Src/phaseEstimater.c **** 	}
 1236              		.loc 1 249 95 discriminator 6 view .LVU395
 1237 024e BCF1000F 		cmp	ip, #0
 1238 0252 7FF43CAF 		bne	.L59
 249:Core/Src/phaseEstimater.c **** 	}
 1239              		.loc 1 249 122 discriminator 8 view .LVU396
 1240 0256 BEF1000F 		cmp	lr, #0
 1241 025a 7FF438AF 		bne	.L59
 249:Core/Src/phaseEstimater.c **** 	}
 1242              		.loc 1 249 148 discriminator 10 view .LVU397
 1243 025e B8F1000F 		cmp	r8, #0
 1244 0262 7FF434AF 		bne	.L59
 1245 0266 49E7     		b	.L60
 1246              	.LVL90:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 31


 1247              	.L63:
 270:Core/Src/phaseEstimater.c **** 				SectorTime = SectorTIM.Instance->CNT;							  // Secure the Sector Time
 1248              		.loc 1 270 5 is_stmt 1 view .LVU398
 270:Core/Src/phaseEstimater.c **** 				SectorTime = SectorTIM.Instance->CNT;							  // Secure the Sector Time
 1249              		.loc 1 270 40 is_stmt 0 view .LVU399
 1250 0268 214E     		ldr	r6, .L88+52
 1251 026a 36F81370 		ldrh	r7, [r6, r3, lsl #1]
 270:Core/Src/phaseEstimater.c **** 				SectorTime = SectorTIM.Instance->CNT;							  // Secure the Sector Time
 1252              		.loc 1 270 19 view .LVU400
 1253 026e 214E     		ldr	r6, .L88+56
 1254 0270 3688     		ldrh	r6, [r6]
 270:Core/Src/phaseEstimater.c **** 				SectorTime = SectorTIM.Instance->CNT;							  // Secure the Sector Time
 1255              		.loc 1 270 7 view .LVU401
 1256 0272 B6EB570F 		cmp	r6, r7, lsr #1
 1257 0276 FFF45AAF 		bcc	.L64
 271:Core/Src/phaseEstimater.c **** 				Prev_Sector_times[PreviousHallSector] = SectorTime;				// The Measured Sector Time is form the 
 1258              		.loc 1 271 5 is_stmt 1 view .LVU402
 271:Core/Src/phaseEstimater.c **** 				Prev_Sector_times[PreviousHallSector] = SectorTime;				// The Measured Sector Time is form the 
 1259              		.loc 1 271 36 is_stmt 0 view .LVU403
 1260 027a 466A     		ldr	r6, [r0, #36]
 271:Core/Src/phaseEstimater.c **** 				Prev_Sector_times[PreviousHallSector] = SectorTime;				// The Measured Sector Time is form the 
 1261              		.loc 1 271 16 view .LVU404
 1262 027c B6B2     		uxth	r6, r6
 1263 027e 1D4F     		ldr	r7, .L88+56
 1264 0280 3E80     		strh	r6, [r7]	@ movhi
 272:Core/Src/phaseEstimater.c **** 				block_commutation_active=0;
 1265              		.loc 1 272 5 is_stmt 1 view .LVU405
 272:Core/Src/phaseEstimater.c **** 				block_commutation_active=0;
 1266              		.loc 1 272 43 is_stmt 0 view .LVU406
 1267 0282 1B4F     		ldr	r7, .L88+52
 1268 0284 27F81360 		strh	r6, [r7, r3, lsl #1]	@ movhi
 273:Core/Src/phaseEstimater.c **** 				}
 1269              		.loc 1 273 5 is_stmt 1 view .LVU407
 273:Core/Src/phaseEstimater.c **** 				}
 1270              		.loc 1 273 29 is_stmt 0 view .LVU408
 1271 0288 144B     		ldr	r3, .L88+32
 1272 028a 0026     		movs	r6, #0
 1273 028c 1E70     		strb	r6, [r3]
 1274 028e 4EE7     		b	.L64
 1275              	.L65:
 285:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1276              		.loc 1 285 4 is_stmt 1 view .LVU409
 285:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1277              		.loc 1 285 72 is_stmt 0 view .LVU410
 1278 0290 1948     		ldr	r0, .L88+60
 1279 0292 30F81260 		ldrh	r6, [r0, r2, lsl #1]
 285:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1280              		.loc 1 285 50 view .LVU411
 1281 0296 A3B2     		uxth	r3, r4
 1282 0298 06FB03F3 		mul	r3, r6, r3
 285:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1283              		.loc 1 285 103 view .LVU412
 1284 029c 144C     		ldr	r4, .L88+52
 1285              	.LVL91:
 285:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1286              		.loc 1 285 103 view .LVU413
 1287 029e 34F81240 		ldrh	r4, [r4, r2, lsl #1]
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 32


 285:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1288              		.loc 1 285 85 view .LVU414
 1289 02a2 93FBF4F3 		sdiv	r3, r3, r4
 285:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1290              		.loc 1 285 30 view .LVU415
 1291 02a6 0B44     		add	r3, r3, r1
 1292 02a8 9BB2     		uxth	r3, r3
 285:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1293              		.loc 1 285 21 view .LVU416
 1294 02aa 2B80     		strh	r3, [r5]	@ movhi
 286:Core/Src/phaseEstimater.c **** 		}
 1295              		.loc 1 286 4 is_stmt 1 view .LVU417
 286:Core/Src/phaseEstimater.c **** 		}
 1296              		.loc 1 286 56 is_stmt 0 view .LVU418
 1297 02ac 30F81200 		ldrh	r0, [r0, r2, lsl #1]
 286:Core/Src/phaseEstimater.c **** 		}
 1298              		.loc 1 286 34 view .LVU419
 1299 02b0 0C18     		adds	r4, r1, r0
 286:Core/Src/phaseEstimater.c **** 		}
 1300              		.loc 1 286 6 view .LVU420
 1301 02b2 A342     		cmp	r3, r4
 1302 02b4 7FF743AF 		ble	.L66
 286:Core/Src/phaseEstimater.c **** 		}
 1303              		.loc 1 286 71 is_stmt 1 discriminator 1 view .LVU421
 286:Core/Src/phaseEstimater.c **** 		}
 1304              		.loc 1 286 88 is_stmt 0 discriminator 1 view .LVU422
 1305 02b8 2C80     		strh	r4, [r5]	@ movhi
 1306 02ba 40E7     		b	.L66
 1307              	.L89:
 1308              		.align	2
 1309              	.L88:
 1310 02bc 00000000 		.word	init.10
 1311 02c0 00000000 		.word	htim6
 1312 02c4 00000000 		.word	HALL1.9
 1313 02c8 00000000 		.word	HALL2.8
 1314 02cc 00040048 		.word	1207960576
 1315 02d0 00000000 		.word	HallSector.3
 1316 02d4 00000000 		.word	HallSector_phase_offset
 1317 02d8 00000000 		.word	PreviousHallSector.2
 1318 02dc 00000000 		.word	block_commutation_active
 1319 02e0 00000000 		.word	prev_phase.0
 1320 02e4 00000000 		.word	lock_HALL1.6
 1321 02e8 00000000 		.word	lock_HALL2.5
 1322 02ec 00000000 		.word	lock_HALL3.4
 1323 02f0 00000000 		.word	Prev_Sector_times
 1324 02f4 00000000 		.word	SectorTime.1
 1325 02f8 00000000 		.word	HallSector_phase_span
 1326 02fc 00000000 		.word	HALL3.7
 1327              	.LVL92:
 1328              	.L61:
 291:Core/Src/phaseEstimater.c **** 		if(block_commutation_active){
 1329              		.loc 1 291 3 is_stmt 1 view .LVU423
 291:Core/Src/phaseEstimater.c **** 		if(block_commutation_active){
 1330              		.loc 1 291 35 is_stmt 0 view .LVU424
 1331 0300 164B     		ldr	r3, .L90
 1332 0302 1988     		ldrh	r1, [r3]
 1333              	.LVL93:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 33


 291:Core/Src/phaseEstimater.c **** 		if(block_commutation_active){
 1334              		.loc 1 291 10 view .LVU425
 1335 0304 164B     		ldr	r3, .L90+4
 1336              	.LVL94:
 291:Core/Src/phaseEstimater.c **** 		if(block_commutation_active){
 1337              		.loc 1 291 10 view .LVU426
 1338 0306 33F81110 		ldrh	r1, [r3, r1, lsl #1]
 1339              	.LVL95:
 292:Core/Src/phaseEstimater.c **** 			motor->rotorphase = offset;
 1340              		.loc 1 292 3 is_stmt 1 view .LVU427
 292:Core/Src/phaseEstimater.c **** 			motor->rotorphase = offset;
 1341              		.loc 1 292 6 is_stmt 0 view .LVU428
 1342 030a 164B     		ldr	r3, .L90+8
 1343 030c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 292:Core/Src/phaseEstimater.c **** 			motor->rotorphase = offset;
 1344              		.loc 1 292 5 view .LVU429
 1345 030e 0BB1     		cbz	r3, .L68
 293:Core/Src/phaseEstimater.c **** 		}
 1346              		.loc 1 293 4 is_stmt 1 view .LVU430
 293:Core/Src/phaseEstimater.c **** 		}
 1347              		.loc 1 293 22 is_stmt 0 view .LVU431
 1348 0310 2980     		strh	r1, [r5]	@ movhi
 1349 0312 16E7     		b	.L67
 1350              	.L68:
 296:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1351              		.loc 1 296 4 is_stmt 1 view .LVU432
 296:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1352              		.loc 1 296 72 is_stmt 0 view .LVU433
 1353 0314 1448     		ldr	r0, .L90+12
 1354 0316 30F81260 		ldrh	r6, [r0, r2, lsl #1]
 296:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1355              		.loc 1 296 50 view .LVU434
 1356 031a A3B2     		uxth	r3, r4
 1357 031c 06FB03F3 		mul	r3, r6, r3
 296:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1358              		.loc 1 296 103 view .LVU435
 1359 0320 124C     		ldr	r4, .L90+16
 1360              	.LVL96:
 296:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1361              		.loc 1 296 103 view .LVU436
 1362 0322 34F81240 		ldrh	r4, [r4, r2, lsl #1]
 296:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1363              		.loc 1 296 85 view .LVU437
 1364 0326 93FBF4F3 		sdiv	r3, r3, r4
 296:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1365              		.loc 1 296 30 view .LVU438
 1366 032a 0B44     		add	r3, r3, r1
 1367 032c 9BB2     		uxth	r3, r3
 296:Core/Src/phaseEstimater.c **** 			if(motor->rotorphase > (offset+HallSector_phase_span[HallSector])) motor->rotorphase= offset+Hal
 1368              		.loc 1 296 21 view .LVU439
 1369 032e 2B80     		strh	r3, [r5]	@ movhi
 297:Core/Src/phaseEstimater.c **** 		}
 1370              		.loc 1 297 4 is_stmt 1 view .LVU440
 297:Core/Src/phaseEstimater.c **** 		}
 1371              		.loc 1 297 56 is_stmt 0 view .LVU441
 1372 0330 30F81220 		ldrh	r2, [r0, r2, lsl #1]
 297:Core/Src/phaseEstimater.c **** 		}
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 34


 1373              		.loc 1 297 34 view .LVU442
 1374 0334 8818     		adds	r0, r1, r2
 297:Core/Src/phaseEstimater.c **** 		}
 1375              		.loc 1 297 6 view .LVU443
 1376 0336 8342     		cmp	r3, r0
 1377 0338 7FF703AF 		ble	.L67
 297:Core/Src/phaseEstimater.c **** 		}
 1378              		.loc 1 297 71 is_stmt 1 discriminator 1 view .LVU444
 297:Core/Src/phaseEstimater.c **** 		}
 1379              		.loc 1 297 88 is_stmt 0 discriminator 1 view .LVU445
 1380 033c 2880     		strh	r0, [r5]	@ movhi
 1381 033e 00E7     		b	.L67
 1382              	.LVL97:
 1383              	.L69:
 309:Core/Src/phaseEstimater.c **** 		rate_of_change = (motor->rotorphase-360)-prev_phase;
 1384              		.loc 1 309 7 is_stmt 1 view .LVU446
 309:Core/Src/phaseEstimater.c **** 		rate_of_change = (motor->rotorphase-360)-prev_phase;
 1385              		.loc 1 309 9 is_stmt 0 view .LVU447
 1386 0340 B3F5967F 		cmp	r3, #300
 1387 0344 04DD     		ble	.L71
 310:Core/Src/phaseEstimater.c **** 	}
 1388              		.loc 1 310 3 is_stmt 1 view .LVU448
 310:Core/Src/phaseEstimater.c **** 	}
 1389              		.loc 1 310 43 is_stmt 0 view .LVU449
 1390 0346 531A     		subs	r3, r2, r1
 1391 0348 A3F5B473 		sub	r3, r3, #360
 310:Core/Src/phaseEstimater.c **** 	}
 1392              		.loc 1 310 18 view .LVU450
 1393 034c 1BB2     		sxth	r3, r3
 1394              	.LVL98:
 310:Core/Src/phaseEstimater.c **** 	}
 1395              		.loc 1 310 18 view .LVU451
 1396 034e 03E7     		b	.L70
 1397              	.LVL99:
 1398              	.L71:
 313:Core/Src/phaseEstimater.c **** 	}
 1399              		.loc 1 313 3 is_stmt 1 view .LVU452
 313:Core/Src/phaseEstimater.c **** 	}
 1400              		.loc 1 313 37 is_stmt 0 view .LVU453
 1401 0350 531A     		subs	r3, r2, r1
 313:Core/Src/phaseEstimater.c **** 	}
 1402              		.loc 1 313 18 view .LVU454
 1403 0352 1BB2     		sxth	r3, r3
 1404              	.LVL100:
 313:Core/Src/phaseEstimater.c **** 	}
 1405              		.loc 1 313 18 view .LVU455
 1406 0354 00E7     		b	.L70
 1407              	.L72:
 317:Core/Src/phaseEstimater.c **** 
 1408              		.loc 1 317 8 is_stmt 1 view .LVU456
 317:Core/Src/phaseEstimater.c **** 
 1409              		.loc 1 317 31 is_stmt 0 view .LVU457
 1410 0356 6A80     		strh	r2, [r5, #2]	@ movhi
 1411 0358 03E7     		b	.L73
 1412              	.L91:
 1413 035a 00BF     		.align	2
 1414              	.L90:
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 35


 1415 035c 00000000 		.word	PreviousHallSector.2
 1416 0360 00000000 		.word	HallSector_phase_offset
 1417 0364 00000000 		.word	block_commutation_active
 1418 0368 00000000 		.word	HallSector_phase_span
 1419 036c 00000000 		.word	Prev_Sector_times
 1420              		.cfi_endproc
 1421              	.LFE128:
 1423              		.section	.bss.prev_phase.0,"aw",%nobits
 1424              		.align	2
 1427              	prev_phase.0:
 1428 0000 00000000 		.space	4
 1429              		.section	.bss.SectorTime.1,"aw",%nobits
 1430              		.align	1
 1433              	SectorTime.1:
 1434 0000 0000     		.space	2
 1435              		.section	.bss.PreviousHallSector.2,"aw",%nobits
 1436              		.align	1
 1439              	PreviousHallSector.2:
 1440 0000 0000     		.space	2
 1441              		.section	.bss.HallSector.3,"aw",%nobits
 1444              	HallSector.3:
 1445 0000 00       		.space	1
 1446              		.section	.bss.lock_HALL3.4,"aw",%nobits
 1449              	lock_HALL3.4:
 1450 0000 00       		.space	1
 1451              		.section	.bss.lock_HALL2.5,"aw",%nobits
 1454              	lock_HALL2.5:
 1455 0000 00       		.space	1
 1456              		.section	.bss.lock_HALL1.6,"aw",%nobits
 1459              	lock_HALL1.6:
 1460 0000 00       		.space	1
 1461              		.section	.bss.HALL3.7,"aw",%nobits
 1464              	HALL3.7:
 1465 0000 00       		.space	1
 1466              		.section	.bss.HALL2.8,"aw",%nobits
 1469              	HALL2.8:
 1470 0000 00       		.space	1
 1471              		.section	.bss.HALL1.9,"aw",%nobits
 1474              	HALL1.9:
 1475 0000 00       		.space	1
 1476              		.section	.bss.init.10,"aw",%nobits
 1479              	init.10:
 1480 0000 00       		.space	1
 1481              		.section	.bss.prev_Sector.11,"aw",%nobits
 1484              	prev_Sector.11:
 1485 0000 00       		.space	1
 1486              		.section	.bss.phase_old.12,"aw",%nobits
 1487              		.align	1
 1490              	phase_old.12:
 1491 0000 0000     		.space	2
 1492              		.section	.bss.lock_HALL3.13,"aw",%nobits
 1495              	lock_HALL3.13:
 1496 0000 00       		.space	1
 1497              		.section	.bss.lock_HALL2.14,"aw",%nobits
 1500              	lock_HALL2.14:
 1501 0000 00       		.space	1
 1502              		.section	.data.lock_HALL1.15,"aw"
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 36


 1505              	lock_HALL1.15:
 1506 0000 01       		.byte	1
 1507              		.section	.bss.HALL3.16,"aw",%nobits
 1510              	HALL3.16:
 1511 0000 00       		.space	1
 1512              		.section	.bss.HALL2.17,"aw",%nobits
 1515              	HALL2.17:
 1516 0000 00       		.space	1
 1517              		.section	.bss.HALL1.18,"aw",%nobits
 1520              	HALL1.18:
 1521 0000 00       		.space	1
 1522              		.section	.bss.voltage_phase.19,"aw",%nobits
 1523              		.align	1
 1526              	voltage_phase.19:
 1527 0000 0000     		.space	2
 1528              		.section	.bss.init.20,"aw",%nobits
 1531              	init.20:
 1532 0000 00       		.space	1
 1533              		.section	.bss.Prev_Sector_times,"aw",%nobits
 1534              		.align	2
 1537              	Prev_Sector_times:
 1538 0000 00000000 		.space	16
 1538      00000000 
 1538      00000000 
 1538      00000000 
 1539              		.section	.data.block_commutation_active,"aw"
 1542              	block_commutation_active:
 1543 0000 01       		.byte	1
 1544              		.global	time_between_sectors
 1545              		.section	.bss.time_between_sectors,"aw",%nobits
 1546              		.align	1
 1549              	time_between_sectors:
 1550 0000 0000     		.space	2
 1551              		.global	HallSector_phase_span
 1552              		.section	.bss.HallSector_phase_span,"aw",%nobits
 1553              		.align	2
 1556              	HallSector_phase_span:
 1557 0000 00000000 		.space	16
 1557      00000000 
 1557      00000000 
 1557      00000000 
 1558              		.global	HallSector_phase_offset
 1559              		.section	.data.HallSector_phase_offset,"aw"
 1560              		.align	2
 1563              	HallSector_phase_offset:
 1564 0000 FF00     		.short	255
 1565 0002 00000000 		.space	14
 1565      00000000 
 1565      00000000 
 1565      0000
 1566              		.global	HallSector_Averages
 1567              		.section	.data.HallSector_Averages,"aw"
 1568              		.align	2
 1571              	HallSector_Averages:
 1572 0000 0100     		.short	1
 1573 0002 00000000 		.space	14
 1573      00000000 
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 37


 1573      00000000 
 1573      0000
 1574              		.text
 1575              	.Letext0:
 1576              		.file 2 "C:/toolchain/arm_gnu_toolchain/arm-none-eabi/include/machine/_default_types.h"
 1577              		.file 3 "C:/toolchain/arm_gnu_toolchain/arm-none-eabi/include/sys/_stdint.h"
 1578              		.file 4 "Drivers/CMSIS/Device/ST/STM32F3xx/Include/stm32f302x8.h"
 1579              		.file 5 "Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_def.h"
 1580              		.file 6 "Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_gpio.h"
 1581              		.file 7 "Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_dma.h"
 1582              		.file 8 "Drivers/STM32F3xx_HAL_Driver/Inc/stm32f3xx_hal_tim.h"
 1583              		.file 9 "Core/Inc/global_var.h"
 1584              		.file 10 "Core/Inc/tim.h"
 1585              		.file 11 "Core/Inc/uart_debug.h"
 1586              		.file 12 "Core/Inc/SVM.h"
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 38


DEFINED SYMBOLS
                            *ABS*:00000000 phaseEstimater.c
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:21     .text.init_phase_estimater:00000000 $t
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:27     .text.init_phase_estimater:00000000 init_phase_estimater
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:73     .text.init_phase_estimater:00000038 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:78     .rodata.initialize_Hallsensor_phase_estimator.str1.4:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:88     .text.initialize_Hallsensor_phase_estimator:00000000 $t
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:94     .text.initialize_Hallsensor_phase_estimator:00000000 initialize_Hallsensor_phase_estimator
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:655    .text.initialize_Hallsensor_phase_estimator:000002b0 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1531   .bss.init.20:00000000 init.20
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1526   .bss.voltage_phase.19:00000000 voltage_phase.19
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1520   .bss.HALL1.18:00000000 HALL1.18
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1515   .bss.HALL2.17:00000000 HALL2.17
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1490   .bss.phase_old.12:00000000 phase_old.12
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1549   .bss.time_between_sectors:00000000 time_between_sectors
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1571   .data.HallSector_Averages:00000000 HallSector_Averages
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1563   .data.HallSector_phase_offset:00000000 HallSector_phase_offset
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1484   .bss.prev_Sector.11:00000000 prev_Sector.11
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1556   .bss.HallSector_phase_span:00000000 HallSector_phase_span
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1505   .data.lock_HALL1.15:00000000 lock_HALL1.15
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1500   .bss.lock_HALL2.14:00000000 lock_HALL2.14
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1495   .bss.lock_HALL3.13:00000000 lock_HALL3.13
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1510   .bss.HALL3.16:00000000 HALL3.16
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:676    .text.initialize_Hallsensor_phase_estimator:000002f4 $t
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:742    .text.initialize_Hallsensor_phase_estimator:00000348 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:752    .text.estimate_rotor_phase:00000000 $t
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:758    .text.estimate_rotor_phase:00000000 estimate_rotor_phase
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1310   .text.estimate_rotor_phase:000002bc $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1479   .bss.init.10:00000000 init.10
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1474   .bss.HALL1.9:00000000 HALL1.9
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1469   .bss.HALL2.8:00000000 HALL2.8
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1444   .bss.HallSector.3:00000000 HallSector.3
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1439   .bss.PreviousHallSector.2:00000000 PreviousHallSector.2
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1542   .data.block_commutation_active:00000000 block_commutation_active
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1427   .bss.prev_phase.0:00000000 prev_phase.0
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1459   .bss.lock_HALL1.6:00000000 lock_HALL1.6
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1454   .bss.lock_HALL2.5:00000000 lock_HALL2.5
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1449   .bss.lock_HALL3.4:00000000 lock_HALL3.4
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1537   .bss.Prev_Sector_times:00000000 Prev_Sector_times
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1433   .bss.SectorTime.1:00000000 SectorTime.1
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1464   .bss.HALL3.7:00000000 HALL3.7
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1331   .text.estimate_rotor_phase:00000300 $t
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1415   .text.estimate_rotor_phase:0000035c $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1424   .bss.prev_phase.0:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1430   .bss.SectorTime.1:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1436   .bss.PreviousHallSector.2:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1445   .bss.HallSector.3:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1450   .bss.lock_HALL3.4:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1455   .bss.lock_HALL2.5:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1460   .bss.lock_HALL1.6:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1465   .bss.HALL3.7:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1470   .bss.HALL2.8:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1475   .bss.HALL1.9:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1480   .bss.init.10:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1485   .bss.prev_Sector.11:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1487   .bss.phase_old.12:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1496   .bss.lock_HALL3.13:00000000 $d
ARM GAS  C:\Users\Simio\AppData\Local\Temp\ccti155R.s 			page 39


C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1501   .bss.lock_HALL2.14:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1511   .bss.HALL3.16:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1516   .bss.HALL2.17:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1521   .bss.HALL1.18:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1523   .bss.voltage_phase.19:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1532   .bss.init.20:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1534   .bss.Prev_Sector_times:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1546   .bss.time_between_sectors:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1553   .bss.HallSector_phase_span:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1560   .data.HallSector_phase_offset:00000000 $d
C:\Users\Simio\AppData\Local\Temp\ccti155R.s:1568   .data.HallSector_Averages:00000000 $d

UNDEFINED SYMBOLS
htim6
HAL_GPIO_ReadPin
HAL_GPIO_TogglePin
setVoltageVector
Motor
UART_transmit_string
UART_transmit_ui32
UART_transmit_crlf
MX_TIM6_Init
